\documentclass{article}
\usepackage{physics}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{framed}
\usepackage{authblk}
\usepackage{empheq}
\usepackage{amsfonts}
\usepackage{esint}
\usepackage[makeroom]{cancel}
\usepackage{dsfont}
\usepackage{centernot}
\usepackage{mathtools}
\usepackage{bigints}
\usepackage{amsthm}
\theoremstyle{definition}
\newtheorem{defn}{Definition}[section]
\newtheorem{prop}{Proposition}[section]
\newtheorem{rmk}{Remark}[section]
\newtheorem{thm}{Theorem}[section]
\newtheorem{exmp}{Example}[section]
\newtheorem{prob}{Problem}[section]
\newtheorem{sln}{Solution}[section]
\newtheorem*{prob*}{Problem}
\newtheorem{exer}{Exercise}[section]
\newtheorem*{exer*}{Exercise}
\newtheorem*{sln*}{Solution}
\usepackage{empheq}
\usepackage{tensor}
\usepackage{xcolor}
%\definecolor{colby}{rgb}{0.0, 0.0, 0.5}
\definecolor{MIT}{RGB}{163, 31, 52}
\usepackage[pdftex]{hyperref}
%\hypersetup{colorlinks,urlcolor=colby}
\hypersetup{colorlinks,linkcolor={MIT},citecolor={MIT},urlcolor={MIT}}  
\usepackage[left=1in,right=1in,top=1in,bottom=1in]{geometry}

\usepackage{newpxtext,newpxmath}
\newcommand*\widefbox[1]{\fbox{\hspace{2em}#1\hspace{2em}}}

\newcommand{\p}{\partial}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\lag}{\mathcal{L}}
\newcommand{\nn}{\nonumber}
\newcommand{\ham}{\mathcal{H}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\I}{\mathcal{I}}
\newcommand{\K}{\mathcal{K}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\w}{\omega}
\newcommand{\lam}{\lambda}
\newcommand{\al}{\alpha}
\newcommand{\be}{\beta}
\newcommand{\x}{\xi}

\newcommand{\G}{\mathcal{G}}

\newcommand{\f}[2]{\frac{#1}{#2}}

\newcommand{\ift}{\infty}

\newcommand{\lp}{\left(}
\newcommand{\rp}{\right)}

\newcommand{\lb}{\left[}
\newcommand{\rb}{\right]}

\newcommand{\lc}{\left\{}
\newcommand{\rc}{\right\}}


\newcommand{\V}{\mathbf{V}}
\newcommand{\U}{\mathcal{U}}
\newcommand{\Id}{\mathcal{I}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\Z}{\mathcal{Z}}

%\setcounter{chapter}{-1}


\usepackage{enumitem}



\usepackage{subfig}
\usepackage{listings}
\captionsetup[lstlisting]{margin=0cm,format=hang,font=small,format=plain,labelfont={bf,up},textfont={it}}
\renewcommand*{\lstlistingname}{Code \textcolor{violet}{\textsl{Mathematica}}}
\definecolor{gris245}{RGB}{245,245,245}
\definecolor{olive}{RGB}{50,140,50}
\definecolor{brun}{RGB}{175,100,80}

%\hypersetup{colorlinks,urlcolor=colby}
\lstset{
	tabsize=4,
	frame=single,
	language=mathematica,
	basicstyle=\scriptsize\ttfamily,
	keywordstyle=\color{black},
	backgroundcolor=\color{gris245},
	commentstyle=\color{gray},
	showstringspaces=false,
	emph={
		r1,
		r2,
		epsilon,epsilon_,
		Newton,Newton_
	},emphstyle={\color{olive}},
	emph={[2]
		L,
		CouleurCourbe,
		PotentielEffectif,
		IdCourbe,
		Courbe
	},emphstyle={[2]\color{blue}},
	emph={[3]r,r_,n,n_},emphstyle={[3]\color{magenta}}
}






\begin{document}
	
\begin{framed}
	\noindent Name: \textbf{Huan Q. Bui}\\
	Course: \textbf{8.309 - Classical Mechanics III}\\
	Problem set: \textbf{\#2}
\end{framed}


\noindent \textbf{1. Canonical Transformations.}


\begin{enumerate}[label=(\alph*)]
	\item Consider the following two generating functions:
	\begin{align*}
	\boxed{F_2(q,P) = q_iP_i \quad\quad\text{and}\quad\quad F_3(p,Q) = -p_iQ_i}
	\end{align*}
	For $F_2$:
	\begin{align*}
	p_i = \f{\p F_2}{\p q_i} = P_i, \quad\quad Q_i = \f{\p F_2}{\p P_i} = q_i
	\end{align*}
	as desired. \\
	
	And for $F_3$:
	\begin{align*}
	q_i = -\f{\p F_3}{\p p_i} = Q_i, \quad\quad P_i = -\f{\p F_3}{\p Q_i} = p_i
	\end{align*}
	as desired. 
	
	
	\item $Q = p/t, P = -qt$. We can choose the following generating function $\boxed{F_1(q,Q,t) = Qqt}$. Let's check that it works:
	\begin{align*}
	p = \f{\p F_1}{\p q} = Qt \implies Q = \f{p}{t},\quad\quad P = -\f{\p F_1}{\p Q} = qt.
	\end{align*}
	
	
	\item We want $F_1 = F_1(q,Q,t)$, so 
	\begin{align*}
	P = -\f{\p F_1}{\p Q} = q^m p^n \implies F = -Qq^m p^n + g(q).
	\end{align*}
	We also want
	\begin{align*}
	p = \f{\p F_1}{\p q} = -Q m q^{m-1} p^n + g'(q) = Q^{1/l}q^{-k/l}.
	\end{align*}
	This equality forces $g(q) = 0$, and so $m=-1,l=1,n=0,k=2$. Therefore,
	\begin{align*}
	\boxed{Q = q^2p \quad\quad P = q^{-1}}
	\end{align*}
	
	
	\item Under the gauge transformation $\vec{A}\to \vec{A}' = \vec{A} + \grad f (\vec{x},t)$, $\phi \to \phi' = \phi - \p_t f(\vec{x},t)$, we have
	\begin{align*}
	\ham' = \f{1}{2m} (\vec{P} - q\vec{A}')^2 + q\phi' = \f{1}{2m} (\vec{P} - q\vec{A} - q\grad f(\vec{X},t))^2 + q\phi(\vec{X},t) - q\f{\p}{\p t} f(\vec{X},t).
	\end{align*}
	Since the $(\vec{p} - q\vec{A})$ term is unchanged, we must have
	\begin{align*}
	 (\vec{P} - q\vec{A}')^2 = (\vec{P} - q\vec{A} - q\grad f(\vec{X},t))^2 = (\vec{p}-q\vec{A})^2.
	\end{align*}
	which gives us one of the transformation: 
	\begin{align*}
	\vec{P} = \vec{p} + q\grad f(\vec{X},t) \implies {\vec{p} = \vec{P} - q\grad f(\vec{X},t)}
	\end{align*}
	The other transformation is simply $\vec{x} = \vec{X}$, and this gives
	\begin{align*}
	\ham'(\vec{X},\vec{P},t) = \ham(\vec{X}, \vec{P},t) -q\f{\p }{\p t} f(\vec{X},t). 
	\end{align*}  
	There is more than one way to show that the transformation 
	\begin{align*}
	\vec{x} = \vec{X} \quad\quad \vec{p} = \vec{P} - q\grad f(\vec{X},t)
	\end{align*}
	is canonical, but we will do this by checking that the fundamental Poissons brackets are correct:
	\begin{align*}
	&\{ X_i, X_j \}_{\vec{x},\vec{p}} = \sum_k \f{\p X_i}{\p x_k} \f{\p X_j}{\p p_k} - \f{\p X_i}{\p p_k} \f{\p X_j}{\p x_k} = \sum_k \delta_{ik}\delta_{jk} - \delta_{ik}\delta_{jk} = 0\\
	&\{ P_i, P_j \}_{\vec{x},\vec{p}} = \sum_k \f{\p P_i}{\p x_k} \f{\p P_j}{\p p_k} - \f{\p P_i}{\p p_k} \f{\p P_j}{\p x_k} = 0\\
	&\{ X_i, P_j \}_{\vec{x},\vec{p}} = \sum_k \f{\p X_i}{\p x_k} \f{\p P_j}{\p p_k} - \f{\p X_i}{\p p_k} \f{\p P_j}{\p x_k} = \sum_k \delta_{ik}\delta_{jk}  =  \delta_{ij}.
	\end{align*}
	So, the transformation is indeed canonical. To find $F_2(\vec{x}, \vec{P},t)$, we require that 
	\begin{align*}
	p_i = \f{\p F_2}{\p x_i} = P_i - q\f{\p}{\p x_j} f(\vec{x},t) \quad\quad \text{and}\quad\quad  X_i = \f{\p F_2}{\p P_i} = x_i
	\end{align*}
	where we have used $\vec{x} = \vec{X}$ to bring the independent variables to $\vec{x}$ and $\vec{P}$. The first equation implies  
	\begin{align*}
	F_2(\vec{x},\vec{P},t) = x_i P_i - f(\vec{x},t) + g(\vec{P}).
	\end{align*}
	With this and the second equation we have
	\begin{align*}
	X_i = x_i - \f{\p}{\p P_i}g(\vec{P}).
	\end{align*}
	We can just set $g(\vec{P}) = 0$. With these, we may write
	\begin{align*}
	\boxed{F_2(\vec{x}, \vec{P},t) = x_i P_i - qf(\vec{x},t) = \vec{x}\cdot \vec{P} - q f(\vec{x},t)}
	\end{align*} 
\end{enumerate}


\noindent \textbf{2. Harmonic Oscillator.} 


\begin{enumerate}[label=(\alph*)]
	\item
	\begin{align*}
	&\{ Q, Q \}_{\vec{q},\vec{p}} = \f{\p Q}{\p q} \f{\p Q}{\p p} - \f{\p Q}{\p p} \f{\p Q}{\p p}= 0\\
	&\{ P, P \}_{\vec{q},\vec{p}} = \f{\p P}{\p q} \f{\p P}{\p p} - \f{\p P}{\p p} \f{\p P}{\p q} = 0\\
	&\{ Q, P \}_{\vec{q},\vec{p}} = \f{\p Q}{\p q} \f{\p P}{\p p} - \f{\p Q}{\p p} \f{\p P}{\p q} = \f{ia}{2ia} - \f{-ia}{2ia} = 1.
	\end{align*}
	Thus, the given transformation is indeed canonical. 
	
	\item From the given transformations, we could solve for $q,p$ in terms of $P,Q$:
	\begin{align*}
	q = \f{1}{2ia}(Q- 2ia P)\quad\quad\text{and}\quad\quad p= \f{1}{2}(Q + 2ia P).
	\end{align*}
	The linear harmonic oscillator Hamiltonian can thus be written as 
	\begin{align*}
	\ham &= \f{p^2}{2m} + \f{m\omega^2q^2}{2}\\ 
	&= \f{1}{2m}\lb \f{1}{2}(Q + 2ia P)  \rb^2 + \f{m\omega^2}{2}\lb \f{1}{2ia}(Q- 2ia P) \rb^2\\
	&=  \f{1}{8m}\lb (Q + 2iaP)^2 - \f{m^2\omega^2}{a^2}( Q - 2iaP)^2 \rb.
	\end{align*}
	An obvious choice for $a$ would be $\boxed{a = m\omega}$, which gives
	\begin{align*}
	\ham = \f{1}{8m} \lb (Q + 2im\omega P)^2 - ( Q - 2i m\omega P)^2 \rb = \f{1}{8m}8im\omega QP = i\omega QP.  
	\end{align*} 
	It is clear that the canonical transformation is not explicitly time-dependent, therefore the generating function is not time-dependent. As a result, $\boxed{K = H = i\omega QP}$. Now we solve for the equations of motion: 
	\begin{align*}
	&\dot Q = \f{\p K }{\p P} = i\omega Q \implies Q(t) = Q_0 e^{i\omega t}\\
	&\dot P = -\f{\p K}{\p Q} = -i\omega P \implies P(t) = P_0 e^{-i\omega t},
	\end{align*}
	where
	\begin{align*}
	&Q_0 = p(0) + im \omega q(0) \\
	&P_0 = \f{p(0) - im\omega q(0)}{2im\omega}.
	\end{align*}
	From $Q(t), P(t)$, we can invert to solve for $q(t),p(t)$:
	\begin{align*}
	\boxed{p(t)} &= \f{1}{2}\lp Q(t) + 2im\omega P(t) \rp\\ 
	&= \f{1}{2}\lp (p(0) + im \omega q(0)) e^{i\omega t} - 2im\omega \f{p(0) - im\omega q(0)}{2im\omega} e^{-i\omega t}    \rp\\
	&= \f{1}{2}\lp (p(0) + im \omega q(0))(\cos \omega t + i\sin\omega t) -  (p(0) - im\omega q(0)) (\cos\omega t - i\sin\omega t )   \rp\\
	&= \boxed{p(0)\cos\omega t - m\omega q(0)\sin\omega t}
	\end{align*}
	and
	\begin{align*}
	\boxed{q(t)} &= \f{1}{2im\omega}(Q(t) - 2im\omega P(t)) \\
	&= \f{1}{2ia}((p(0) + im \omega q(0))e^{i\omega t}- 2im\omega \f{p(0) - im\omega q(0)}{2im\omega }e^{-i\omega t})\\
	&= \f{1}{2ia}\lp(p(0) + im \omega q(0))(\cos \omega t + i\sin\omega t) - (p(0) - im\omega q(0))(\cos \omega t - i\sin\omega t) \rp\\
	&= \boxed{q(0)\cos\omega t + \f{p(0)}{m\omega} \sin\omega t}
	\end{align*}

\end{enumerate}


\noindent \textbf{3. Poisson Brackets and Conserved Quantities.}
Given 
\begin{align*}
\ham = q_1 p_1 - q_2 p_2 + aq_1^2 + bq_2^2 
\end{align*}
where $a,b$ are constants. To show that $u_1 = (p_1+aq_1)/q_2$ and $u_2 = q_1q_2$ are constants of motion we check that $du_1/dt = 0 = du_2/dt$. Since $\p u_1 /\p t = \p u_2 /\p t = 0$, it suffices to check that $\{ u_1,\ham\} = \{ u_2,\ham\} = 0$:
\begin{align*}
\{ u_1, \ham \} 
&= \lp \f{ \p u_1}{\p q_1}\f{\p \ham}{\p p_1} - \f{\p u_1}{\p p_1} \f{\p \ham}{\p q_1}\rp +  \lp \f{ \p u_1}{\p q_2}\f{\p \ham}{\p p_2} - \f{\p u_1}{\p p_2} \f{\p \ham}{\p q_2}\rp \\
&=   \lb\f{a}{q_2}q_1 - \f{1}{q_2}(p_1 + 2aq_1)\rb  + \lb -\f{(p_1+aq_1)}{q_2^2} (-q_2) - 0\rb\\
&= \f{1}{q_2}\lb aq_1 - p_1 - 2aq_1 + p_1 + aq_1 \rb \\
&=0 \quad\quad \checkmark
\end{align*}
\begin{align*}
\{ u_2, \ham \}
&= \lp \f{ \p u_2}{\p q_1}\f{\p \ham}{\p p_1} - \f{\p u_2}{\p p_1} \f{\p \ham}{\p q_1}\rp +  \lp \f{ \p u_2}{\p q_2}\f{\p \ham}{\p p_2} - \f{\p u_2}{\p p_2} \f{\p \ham}{\p q_2}\rp  \\
&= \lb q_2 q_1 - 0 \rb + \lb  q_1 (-q_2)  \rb\\
&= 0. \quad\quad \checkmark
\end{align*}
 

\noindent \textbf{4. Angular Momentum and the Laplace-Runge-Lenz vector.}\\

\begin{enumerate}[label=(\alph*)]
	\item To avoid unnecessary repeated indices we will replace $i,j,k$ by $a,b,c$ when needed: 
	\begin{align*}
	\boxed{\{ x_i, L_j \}} &= \{ x_i , \epsilon_{jka}x_k p_a \} = \sum_{l}\f{\p x_i}{\p x_l}\f{\p \epsilon_{jka}x_k p_a}{\p p_l} - \f{\p x_i}{\p p_l}\f{\p \epsilon_{jka}x_k p_a}{\p x_l}= \sum_l \delta_{il}\epsilon_{jki}x_k\delta_{al} = {\epsilon_{jki}x_k} = \boxed{\epsilon_{ijk}x_k}
	\end{align*}
	\begin{align*}
	\boxed{\{ p_i, L_j \}} &= \{ p_i , \epsilon_{jka}x_k p_a \} 
	= \sum_{l}\f{\p p_i}{\p x_l}\f{\p \epsilon_{jka}x_k p_a}{\p p_l} - \f{\p p_i}{\p p_l}\f{\p \epsilon_{jka}x_k p_a}{\p x_l}
	= \sum_l -\delta_{il}\epsilon_{jka}p_a\delta_{kl}
	= -\epsilon_{jia}p_a    
	=\boxed{\epsilon_{ijk}p_k} 
	\end{align*}
	Next, 
	\begin{align*}
	\{ L_i, L_b \} &= \{ \epsilon_{ijk}x_j p_k , \epsilon_{bca}x_c p_a \} \\
	&= \sum_{l}\f{\p \epsilon_{ijk}x_j p_k}{\p x_l}\f{\p \epsilon_{bca}x_c p_a}{\p p_l} - \f{\p \epsilon_{ijk}x_j p_k}{\p p_l}\f{\p \epsilon_{bca}x_c p_a}{\p x_l}\\
	&= \sum_l \delta_{jl}\epsilon_{ijk}p_k \delta_{al} \epsilon_{bca}x_c - \delta_{kl}\epsilon_{ijk}x_j \delta_{cl}\epsilon_{bca}p_a \\
	&=\epsilon_{ijk}\epsilon_{bcj} p_k x_c - \epsilon_{ijk}\epsilon_{bka} x_j p_a\\
	&=-\epsilon_{ikj}\epsilon_{bcj}p_k x_c + \epsilon_{ijk}\epsilon_{bak}x_j p_a\\
	&=-(\delta_{ib}\delta_{kc} - \delta_{ic}\delta_{kb})p_kx_c + (\delta_{ib}\delta_{ja} - \delta_{ia}\delta_{jb})x_jp_a \\
	&=-\delta_{ib}p_kx_k + x_ip_b + \delta_{ib}x_jp_j - x_bp_i\\
	&= x_ip_b - x_bp_i.
	\end{align*}
	Putting back $b=j$ we get the final result
	\begin{align*}
	\boxed{\{ L_i ,L_j\}} = x_i p_j - x_j p_i = (\delta_{iu}\delta_{jv} - \delta_{iv}\delta_{ju})x_up_v = \epsilon_{ijk}\epsilon_{uvk} x_up_v = \epsilon_{ijk}\epsilon_{kuv}x_up_v = \boxed{\epsilon_{ijk}L_k}
	\end{align*}
	To calculate $\{ L_i \vec{L}^2 \}$, we have to be more explicit with our index notation. To be explicit we will say $L_aL_a = L_a^2 \neq \vec{L}^2$ and use the ``product rule'' for Poisson brackets $\{ uv,w \} = u\{v,w\} + \{u,w\}v $.
	\begin{align*}
	\{ L_i , \vec{L}^2 \} 
	&= \{ L_i , L_i L_i + L_jL_j + L_kL_k \} = \{L_i, L_iL_i\} +  \{L_i, L_jL_j \} + \{ L_i, L_kL_k \}
	\end{align*}
	since $\{L_i,L_i\} = 0$, the first term on the RHS is zero, which leaves us with
	\begin{align*}
	\boxed{\{ L_i , \vec{L}^2 \}} &= -\{L_jL_j, L_i\} - \{ L_kL_k, L_i \} \\
	&= -L_j\{ L_j,L_i \} - \{L_j,L_i\}L_j - L_k\{ L_k,L_i \} + \{L_k,L_i\}L_k \\
	&= 2L_j\epsilon_{ijk}L_k + 2L_k \epsilon_{ika}L_a\\
	&= 2\epsilon_{ijk}L_jL_k - 2\epsilon_{iak}L_aL_k\\
	&=\boxed{0}
	\end{align*}
	
	\item Since $\vec{A} = \vec{p}\times \vec{L} - \mu k\vec{r} /r$, to show that $\vec{A}$ is conserved we check that $\{ \vec{A} , \ham\} = 0$, i.e., $\{ A_i,\ham \} = 0$. To do this, we must first write everything in terms of components and computer their derivatives
	\begin{align*}
	\vec{A} = \vec{p}\times \vec{L} - \f{\mu k \vec{r}}{r} \implies A_i &=  \epsilon_{ijk}p_jL_k - \f{\mu k \vec{r}_i}{r}\\
	&= \epsilon_{ijk}\epsilon_{kab} p_jr_ap_b - \f{\mu k r_i}{r} \\ 
	&= \epsilon_{ijk}\epsilon_{abk} p_jr_ap_b - \f{\mu k r_i}{r} \\ 
	&= (\delta_{ia}\delta_{jb} - \delta_{ib}\delta_{ja})p_jr_a p_b - \f{\mu k t_i}{r} \\ 
	&= r_i p_jp_j  - p_j r_j p_i - \f{\mu k r_i}{r} \\
	&= r_i \vec{p}^2  - p_j r_j p_i - \f{\mu k r_i}{r} \\
	\end{align*}
	With this, 
	\begin{align*}
	\f{\p A_i}{\p r_l} &= \delta_{il}\vec{p}^2  - p_jp_i \delta_{jl} - \mu k \lp \delta_{il}\f{1}{r} - \f{r_i}{r^2}\f{\p r}{\p r_l} \rp\\ 
	&= \delta_{il} \vec{p}^2  - p_l p_i - \mu k \lp \f{\delta_{il}}{r} - \f{r_ir_l}{r^3} \rp \\
	&= \delta_{il} \vec{p}^2 - p_l p_i - \f{\mu k}{r} \lp \delta_{il} - \f{r_ir_l}{r^2} \rp 
	\end{align*}
	where we have used the fact that
	\begin{align*}
	\f{\p r}{\p r_l} = \f{\p \sqrt{r_l r_l}}{\p r_l} = \f{1}{\sqrt{r_lr_l}}2\f{1}{2}r_l = \f{r_l}{r}.
	\end{align*}
	We also need to find $\p A_i/\p p_l$:
	\begin{align*}
	\f{\p A_i}{\p p_l} = 2r_i p_j \delta_{jl} - r_j\delta_{jl}p_i- p_j r_j \delta_{il} = 2 r_i p_l - r_lp_i - p_j r_j \delta_{il}.
	\end{align*}
	The next step is to do the same for $\ham = \vec{p}^2/2\mu - k/r $:
	\begin{align*}
	\f{\p \ham}{\p r_l} = -k\f{\p}{\p r_l}\f{1}{r} = \f{k}{r^2}\f{\p r}{\p r_l} = \f{kr_l}{r^3}.
	\end{align*}
	\begin{align*}
	\f{\p \ham}{\p p_l} = \f{1}{2\mu} \f{\p p_i p_i}{\p p_l} = \f{1}{\mu} p_i \delta_{il} = \f{p_l}{\mu}.
	\end{align*}
	With these, we are ready:
	\begin{align*}
	\{ A_i , \ham \} &= \sum_l \f{\p A_i}{\p r_l}\f{\p \ham}{\p p_l} - \f{\p A_i}{\p p_l}\f{\p \ham}{\p r_l} \\
	&= \sum_l   \lp \delta_{il} \vec{p}^2 - p_l p_i - \f{\mu k}{r} \lp \delta_{il} - \f{r_ir_l}{r^2} \rp  \rp \f{p_l}{\mu} - (2 r_i p_l - r_lp_i - p_j r_j \delta_{il})\f{kr_l}{r^3} \\
	&= \cancel{\f{1}{\mu}p_i \vec{p}^2}  -\cancel{\f{1}{\mu} p_i \vec{p}^2} - \f{k }{r}\lp p_i - \f{r_i r_l p_l}{r^2}  \rp  
	- \f{k}{r^3}(2r_ip_lr_l - r_l p_i r_l - p_jr_j r_i)\\
	&= -p_i\f{k}{r} + r_i\f{k\vec{r}\cdot \vec{p}}{r^3} - r_i\f{2k \vec{r}\cdot \vec{p}}{r^3} + p_i \f{k}{r} + r_i\f{k \vec{r}\cdot \vec{p}}{r^3} \\
	&= \lp -p_i\f{k}{r} + p_i \f{k}{r} \rp + \lp r_i\f{k\vec{r}\cdot \vec{p}}{r^3} - r_i\f{2k \vec{r}\cdot \vec{p}}{r^3} +  r_i\f{k \vec{r}\cdot \vec{p}}{r^3} \rp \\
	&= 0.
	\end{align*}
	So, the Laplace-Runge-Lenz vector is conserved, as desired. 
	
	
	
	\item We first find what $\vec{L}^2$ is in terms of $\vec{x}, \vec{p}$:
	\begin{align*}
	\vec{L}^2 &= L_i L_i\\
	&= \epsilon_{ijk}Lr_jp_k \epsilon_{ibc}r_bp_c = \epsilon_{jki}\epsilon_{bci}r_jr_bp_kp_c\\
	&= (\delta_{jb}\delta_{kc} - \delta_{jc}\delta_{kb})r_jr_bp_kp_c \\
	&= r_jr_jp_kp_k - r_jp_j r_k p_k \\
	&= \vec{r}^2\vec{p}^2 - (\vec{r}\cdot \vec{p})^2
	\end{align*}
	With this, we expand the LHS and simplify to get $\vec{A}^2$:
	\begin{align*}
	\mu^2 k^2 + 2\mu \ham \vec{L}^2 
	&= \mu^2k^2 + 2\mu \lp \f{\vec{p}^2}{2\mu} - \f{k}{r} \rp \lb \vec{r}^2\vec{p}^2 - (\vec{r}\cdot \vec{p})^2 \rb \\ 
	&= \mu^2 k^2 +  \lp \vec{p}^2 - \f{2\mu k }{r} \rp \lb \vec{r}^2\vec{p}^2 - (\vec{r}\cdot \vec{p})^2 \rb \\
	&= \mu^2k^2 + \vec{p}^2 \vec{r}^2 \vec{p}^2 - \vec{p}^2 (\vec{r}\cdot \vec{p})^2 - \f{2\mu k }{r}\vec{r}^2 \vec{p}^2  + \f{2\mu k }{r} (\vec{r}\cdot \vec{p})^2 \\
	&= \vec{r}^2 \lp \vec{p}^2 \vec{p}^2 - \f{2\mu k }{r}\vec{p}^2 + \f{\mu^2 k^2}{r^2}\rp -2 (\vec{r}\cdot \vec{p} )^2 \lp \vec{p}^2- \f{\mu k }{r} \rp  + (\vec{r}\cdot \vec{p})^2\vec{p}^2\\
	&= (r_ir_i)\lp \vec{p} - \f{\mu k }{r} \rp^2 -2 (r_ip_i)(\vec{r}\cdot \vec{p}) \lp \vec{p}^2- \f{\mu k }{r} \rp  + (\vec{r}\cdot{\vec{p}}) p_i p_i\\ 
	&= {\underbrace{\lb  r_i\lp \vec{p} - \f{\mu k }{r} \rp - (\vec{r}\cdot \vec{p}) p_i  \rb}_{A_i}}^2\\
	&= \vec{A}^2 \quad\checkmark
	\end{align*}
	where we have used the previously derived result:
	\begin{align*}
	A_i = r_i\vec{p}^2 - p_jr_j p_i - \f{k\mu r_i}{r} = r_i \lp \vec{p}^2 - \f{\mu k }{r} \rp - (\vec{r}\cdot \vec{p}) p_i.
	\end{align*}
\end{enumerate}








\noindent \textbf{5. An Exponential Potential. }
\begin{enumerate}[label=(\alph*)]
	\item $\ham = p^2 + e^x$. We want $K = P^2 = H = p^2 + e^x$. Since $p>0$, we have $p = \sqrt{P^2 - e^x}$. With this, 
	\begin{align*}
	p = \f{\p F_2}{\p x} = \sqrt{P^2 - e^x} \implies F_2(x,P) = 2\sqrt{P^2 - e^x} - 2P \tanh^{-1}\lp \f{\sqrt{P^2- e^x}}{P}\rp + g(P).
	\end{align*} 
	Since we don't have any requirements from $X = X(x,P)$, we may as well set $g(P) = 0$, so that
	\begin{align*}
	\boxed{F_2(x,P) = 2\sqrt{P^2 - e^x} - 2P \tanh^{-1}\lp \f{\sqrt{P^2- e^x}}{P}\rp   } 
	\end{align*}
	Mathematica code:
	\begin{lstlisting}
	F2 = Integrate[Sqrt[P^2 - E^x], x]
	
	>>>> 2 Sqrt[-E^x + P^2] - 2 P ArcTanh[Sqrt[-E^x + P^2]/P]
	\end{lstlisting}
	
	
	
	
	\item The transformation equations can be obtained from $F_2$. First, assuming $P>0$ we have that
	\begin{align*}
	\boxed{P(x,p) = \sqrt{p^2 + e^x}}
	\end{align*}
	Next,
	\begin{align*}
	X(x,p) = \f{\p F_2}{\p P} = \f{\p }{\p P}\lb 2\sqrt{P^2 - e^x} - 2P \text{arctanh}\lp \f{\sqrt{P^2- e^x}}{P}\rp   \rb = -2\text{arccoth}\lp \f{P}{\sqrt{P^2 - e^x}} \rp
	\end{align*} 
	Substituting in the result for $P$ we find 
	\begin{align*}
	\boxed{X(x,p)} = -2\text{arccoth}\lp \f{\sqrt{p^2 +e^x}}{\sqrt{p^2 + e^x - e^x}} \rp =  \boxed{-2\text{arccoth}\lp \f{\sqrt{p^2 +e^x}}{p} \rp}
	\end{align*}
	Mathematica code:
	\begin{lstlisting}
	D[F2, P] // FullSimplify
	
	>>>> -2 ArcCoth[P/Sqrt[-E^x + P^2]]
	\end{lstlisting}
	Assuming $P<0$ gives us another set of transformation equations:
	\begin{align*}
	\boxed{P(x,p) = -\sqrt{p^2 + e^x}} \quad\quad \boxed{X(x,p) =  -2\text{arccoth}\lp \f{-\sqrt{p^2 +e^x}}{p} \rp }
	\end{align*}
	
	
	
	\item To determine $x(t),p(t)$ we may solve for the Hamilton EOMs for $K$ first:
	\begin{align*}
	\dot P = -\f{\p K }{\p X} = 0 &\implies P = \pm \sqrt{p^2 +e^x}  =  \text{constant} = \pm P_0 := \pm \sqrt{p(0)^2 + e^{x(0)} }\\
	\dot X = \f{\p K}{\p P} =  2P &\implies X = 2Pt + X_0\\ 
	&\implies -2\text{arccoth}\lp \f{\pm \sqrt{p^2 +e^x}}{p} \rp = -2\text{arccoth}\lp \f{\pm P_0}{p(t)} \rp   = \pm 2P_0 t + C \\
	&\implies {p(t) = \mp  P_0\tanh\lp \f{X_0}{2} \pm  tP_0 \rp}
	\end{align*}
	From this, we can invert to find $x(t)$:
	\begin{align*}
	e^{x(t)}= P^2 - p^2 = P_0^2 - P_0^2 \tanh^2\lp \f{X_0}{2} \pm t P_0 \rp \implies { x(t) = \ln \lb P_0^2 -  P_0^2\tanh^2\lp \f{X_0}{2} \pm t P_0  \rp \rb}
	\end{align*}
	where $P_0$ is already defined above and $X_0 = -2\text{arccoth}(\pm P_0/p(0))$. We also answer whether the signs matter i.e., whether there is a ``preferred'' set of transformation equations. Suppose that $P > 0$, then 
	\begin{align*}
	p(t) = -P_0 \tanh\lp \f{X_0}{2} + tP_0 \rp.
	\end{align*}
	At $t=0$, we have $p(0) = -P_0 \tanh( X_0/2 )$ where $X_0 = -2\text{arccoth}(P_0/p(0)) < 0$, and so $p(t) > 0.\quad \checkmark$\\
	
	
	On the other hand if we pick the $P<0$ transformation then
	\begin{align*}
	p(t) = P_0 \tanh\lp \f{X_0}{2} - tP_0 \rp.
	\end{align*}
	At $t=0$, we have $p(0) = P_0 \tanh\lp X_0/2 \rp$ where $X_0 = -2\text{arccoth}(-P_0/p(0)) > 0$, and so $p(t) > 0.\quad \checkmark$\\
	
	Therefore, either transformation works, so we may as well choose the positive transformation can obtain the following solution:
	\begin{align*}
	\boxed{p(t) = -P_0\tanh\lp \f{X_0}{2} +  tP_0 \rp \quad\quad\text{and}\quad\quad x(t) = \ln \lb P_0^2 -  P_0^2\tanh^2\lp \f{X_0}{2} + t P_0  \rp \rb}
	\end{align*}
	where
	\begin{align*}
	X_0 = -2\text{arccoth}\lp \f{\sqrt{p(0)+e^{x(0)}}}{p(0)} \rp \quad\quad \text{and}\quad\quad P_0 =\sqrt{p(0)^2 + e^{x(0)}}
	\end{align*}
	
	Mathematica code:
	\begin{lstlisting}
	(* Positive solution *)
	Solve[-2 ArcCoth[Z/p[t]] == 2*Z*t + C, p[t]] // FullSimplify
	
	p[t] -> -Z Tanh[C/2 + tZ]
	
	(* Negative solution *)
	Solve[-2 ArcCoth[-Z/p[t]] == -2*Z*t + C, p[t]] // FullSimplify
	
	p[t] -> Z Tanh[C/2 - tZ]
	\end{lstlisting}
	
\end{enumerate}




\noindent \textbf{6. Projectile with Hamilton-Jacobi.}

Our (Hamiltonian) coordinates will be $p_x, p_y, x,y$. The Hamiltonian is simply the energy:
\begin{align*}
\ham = \f{p_x^2}{2m} + \f{p_y^2}{2m} + mgy = E
\end{align*}
The Hamilton-Jacobi equation says 
\begin{align*}
\ham \lp x,y, \f{\p S}{\p x}, \f{\p S}{\p y}, t \rp + \f{\p S}{\p t} = 0
\end{align*}
which in our case becomes
\begin{align*}
\f{1}{2m} \lb \lp \f{\p S}{\p x} \rp^2 + \lp\f{\p S}{\p y}\rp^2 \rb + mgy + \f{\p S}{\p t} = 0 &\implies 
\f{1}{2m} \lb \lp \f{\p S_{xy}}{\p x} \rp^2 + \lp\f{\p S_{xy}}{\p y}\rp^2 \rb + mgy  = \al_1 = -\f{\p S_t}{\p t}
\end{align*}
where we have used the fact that $p_i = \p S / \p x_i$ and that $S$ is separable in spatial and time coordinates: $S = S_{xy} + S_t$ where $S_{xy}$ has no $t$-dependence and $S_t$ has no spatial dependence. From here we find that
\begin{align*}
S_t = -\al_1 t.
\end{align*}
We now solve the spatial part:
\begin{align*}
\f{1}{2m} \lb \lp \f{\p S_{xy}}{\p x} \rp^2 + \lp\f{\p S_{xy}}{\p y}\rp^2 \rb + mgy  = \al_1 \implies \f{1}{2m}\lp  \f{\p S_{xy}}{\p x}\rp^2  =  \al_1 - \f{1}{2m}\lp \f{\p S_{xy}}{\p y} \rp^2 -mgy = \al_2
\end{align*}
where $\al$ is constant. By separability we may as well write $S_{xy} = S_x + S_y$ where $S_x$ has no $y$-dependence and $S_y$ has no $x$-dependence. From here we find that 
\begin{align*}
\f{\p S_x}{\p x} = \pm\sqrt{2m \al_2 } \implies S_x = \pm \int \sqrt{2m\al_2}\,dx
\end{align*}
and 
\begin{align*}
\f{\p S_y}{\p y} = \pm \sqrt{2m(\al_1-\al_2 - mgy)}  \implies S_y = \pm \int \sqrt{2m(\al_1-\al_2 - mgy)}\,dy.
\end{align*}
The full solution is therefore
\begin{align*}
S = S_x + S_y + S_t = \pm \int \sqrt{2m\al_2}\,dx \pm \int \sqrt{2m(\al_1-\al_2 - mgy)}\,dy -\al_1 t.
\end{align*}
From here, we solve for the constants $\be_1,\be_2$:
\begin{align*}
&\be_1 = \f{\p S}{\p \al_1} = -t \pm \int \f{m}{\sqrt{2m(\al_1-\al_2 - mgy)}}\,dy \\
&\be_2 = \f{\p S}{\p \al_2} = \pm \int \f{m}{\sqrt{2m \al_2}}\,dx \mp  \int \f{m}{\sqrt{2m(\al_1 - \al_2 - gmy)}}\,dy = \pm \int \f{m}{\sqrt{2m \al_2}}\,dx \mp (\be_1 + t)
\end{align*}
Solving the first equation for $y$ we find 
\begin{align*}
t + \be_1 = \pm \f{1}{mg} \sqrt{2m(\al_1 - \al_2 - mgy)} \implies y(t) = \f{\al_1 - \al_2}{mg} - \f{1}{2}g(t+\be_1)^2.
\end{align*}
Inverting the first equation we find 
\begin{align*}
x(t) = \pm  \f{\sqrt{2m\al_2}}{m} \lb \be_2 \pm (\be_1 + t) \rb.
\end{align*}
It remains to solve for $\al_1,\al_2, \be_1,\be_2$. We know that $\al_1 = E$, the total energy, which is just the initial kinetic energy (as the object was launched from the ground), so $E = \al_1= mv_0^2/2$. At $t=0$, we have
\begin{align*}
x(0) = \pm \f{\sqrt{2m \al_2}}{m}[\be_2 \pm \be_1] = y(0) =  \f{mv_0^2/2 - \al_2}{mg} - \f{1}{2}g\be_1^2 =0.
\end{align*} 
So $\be_2 = \mp \be_1$. Since $x(t)> 0$, we may take the positive solution:
\begin{align*}
x(t) = \f{\sqrt{2m\al_2}}{m}t \implies \dot x(0) = v_0\cos \theta = \f{\sqrt{2m\al_2}}{m} \implies \al_2 = \f{m v_0^2\cos^2\theta}{2}.
\end{align*}
We then solve for $\be_1$:
\begin{align*}
\f{mv_0^2/2 - mv_0^2\cos^2\theta/2}{mg} = \f{1}{2}g\be_1^2 \implies \be_1 = \pm \sqrt{\f{v_0^2\sin^2\theta}{g^2}}.
\end{align*}
In order for $\dot y(0) > 0$, $\be_2 < 0$. Thus, we take the negative solution for $\be_2$:
\begin{align*}
\dot y(0) = -g\be_1 > 0\implies \be_1 < 0 \implies \be_1 = -\f{v_0 \sin\theta}{g}
\end{align*}
Putting everything back we get the equations for $x(t)$ and $y(t)$:
\begin{align*}
\boxed{x(t) = v_0 t\cos\theta}\quad  \checkmark \quad\quad\quad \boxed{y(t) = \f{v_0^2\sin^2\theta}{2g} - \f{1}{2}g\lp t - \f{v_0\sin\theta}{g} \rp^2 = v_0t\sin\theta-\f{1}{2}gt^2} \quad \checkmark
\end{align*}
From here, it is easy to find the momentum coordinates:
\begin{align*}
&p_x = \f{\p S}{\p x} = \sqrt{2m\al_2} = mv_0\cos\theta \quad\checkmark \\
&p_y = \f{\p S}{\p y} = \sqrt{2m(\al_1 - \al_2 - mgy)} = m(v_0\sin\theta - gt) \quad\checkmark
\end{align*}
Finally, we want to solve for the equation of the trajectory, i.e. we want to solve for $y(x)$. To do this, we solve for $t$ in terms of $x$:
\begin{align*}
t(x) = \f{x}{v_0\cos\theta}
\end{align*}
and plug into the equation for $y(t)$:
\begin{align*}
\boxed{y(x) = \f{v_0\sin\theta x}{v_0\cos\theta} - \f{1}{2}g \lp \f{x^2}{v_0^2\cos\theta^2} \rp = x\tan\theta - \f{x^2}{2g^2v_0^2\cos^2\theta}}
\end{align*}

\end{document}



