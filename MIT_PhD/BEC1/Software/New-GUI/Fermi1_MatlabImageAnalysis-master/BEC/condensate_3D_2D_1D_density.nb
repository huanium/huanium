(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15910,        531]
NotebookOptionsPosition[     14357,        474]
NotebookOutlinePosition[     14705,        489]
CellTagsIndexPosition[     14662,        486]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "\n",
 StyleBox["Condensate ", "Chapter"],
 "\n"
}], "Text",
 CellChangeTimes->{{3.72815066581709*^9, 3.728150667887583*^9}, {
   3.72815120161928*^9, 3.728151204490924*^9}, 3.7281512778100395`*^9, {
   3.7281515749096766`*^9, 3.7281515897933407`*^9}, 3.728151731558553*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$Assumptions", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"y0", ">", "0"}], ",", 
    RowBox[{"z0", ">", "0"}], ",", 
    RowBox[{"x0", ">", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7281499932306495`*^9, 3.7281500105828295`*^9}, {
  3.728150327456591*^9, 3.728150330492708*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"y0", ">", "0"}], ",", 
   RowBox[{"z0", ">", "0"}], ",", 
   RowBox[{"x0", ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.728150010836505*^9, 3.728150330787451*^9, 
  3.728151722423418*^9, 3.728674406233596*^9, 3.731154933071433*^9, 
  3.73125557967129*^9}]
}, Open  ]],

Cell["3D condensate distribution,  Eqn 43 in varenna BEC notes", "Text",
 CellChangeTimes->{{3.7281511775041065`*^9, 3.7281511893606567`*^9}, {
   3.731255504722727*^9, 3.731255509396165*^9}, 3.7312555624275827`*^9, {
   3.7312556226195154`*^9, 3.73125562731322*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nc3", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"nc", "*", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"x", "^", "2"}], "/", 
      RowBox[{"x0", "^", "2"}]}], "-", 
     RowBox[{
      RowBox[{"y", "^", "2"}], "/", 
      RowBox[{"y0", "^", "2"}]}], "-", 
     RowBox[{
      RowBox[{"z", "^", "2"}], "/", 
      RowBox[{"z0", "^", "2"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.728150299071047*^9, 3.7281503244596233`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.731154959234127*^9, 3.731154968655267*^9}, {
  3.7312555633633747`*^9, 3.731255572673635*^9}}],

Cell["Integrate out x-direction, into 2D column density", "Text",
 CellChangeTimes->{
  3.7312555705930405`*^9, {3.731255607792063*^9, 3.731255620483941*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"nc3", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{
      RowBox[{"-", "x0"}], "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"y", "^", "2"}], "/", 
         RowBox[{"y0", "^", "2"}]}], "-", 
        RowBox[{
         RowBox[{"z", "^", "2"}], "/", 
         RowBox[{"z0", "^", "2"}]}]}], "]"}]}], ",", 
     RowBox[{"x0", "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"y", "^", "2"}], "/", 
         RowBox[{"y0", "^", "2"}]}], "-", 
        RowBox[{
         RowBox[{"z", "^", "2"}], "/", 
         RowBox[{"z0", "^", "2"}]}]}], "]"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7281503331808205`*^9, 3.728150393192561*^9}}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", "nc", " ", "x0", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["y0", "2"]}], " ", 
           SuperscriptBox["z", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y"}], "+", "y0"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"y", "+", "y0"}], ")"}], " ", 
           SuperscriptBox["z0", "2"]}]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}], 
      RowBox[{"3", " ", 
       SuperscriptBox["y0", "3"], " ", 
       SuperscriptBox["z0", "3"]}]]}], "+", 
    FractionBox[
     RowBox[{"2", " ", "nc", " ", "x0", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["y", "2"]}], " ", 
          SuperscriptBox["z0", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["y0", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["z", "2"]}], "+", 
            SuperscriptBox["z0", "2"]}], ")"}]}]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}], 
     RowBox[{
      SuperscriptBox["y0", "3"], " ", 
      SuperscriptBox["z0", "3"]}]]}], ",", 
   RowBox[{
    SqrtBox[
     RowBox[{"1", "-", 
      FractionBox[
       SuperscriptBox["y", "2"], 
       SuperscriptBox["y0", "2"]], "-", 
      FractionBox[
       SuperscriptBox["z", "2"], 
       SuperscriptBox["z0", "2"]]}]], "\[Element]", "Reals"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.7281504098227797`*^9, 3.728151738215268*^9, 
  3.728674421358162*^9, 3.7311549477933025`*^9, 3.7312556028451204`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n2D", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", "nc", " ", "x0", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["y0", "2"]}], " ", 
           SuperscriptBox["z", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y"}], "+", "y0"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"y", "+", "y0"}], ")"}], " ", 
           SuperscriptBox["z0", "2"]}]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}], 
      RowBox[{"3", " ", 
       SuperscriptBox["y0", "3"], " ", 
       SuperscriptBox["z0", "3"]}]]}], "+", 
    FractionBox[
     RowBox[{"2", " ", "nc", " ", "x0", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["y", "2"]}], " ", 
          SuperscriptBox["z0", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["y0", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["z", "2"]}], "+", 
            SuperscriptBox["z0", "2"]}], ")"}]}]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}], 
     RowBox[{
      SuperscriptBox["y0", "3"], " ", 
      SuperscriptBox["z0", "3"]}]]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7281506925662208`*^9, 3.7281507162001214`*^9}, {
  3.7281516302349105`*^9, 3.728151632025676*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "nc", " ", "x0", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["y0", "2"]}], " ", 
       SuperscriptBox["z", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "y"}], "+", "y0"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"y", "+", "y0"}], ")"}], " ", 
       SuperscriptBox["z0", "2"]}]}], ")"}], 
    RowBox[{"3", "/", "2"}]]}], 
  RowBox[{"3", " ", 
   SuperscriptBox["y0", "3"], " ", 
   SuperscriptBox["z0", "3"]}]]], "Output",
 CellChangeTimes->{{3.728150702027398*^9, 3.7281507167345366`*^9}, 
   3.728151632492919*^9, 3.7281517382784357`*^9, 3.7286744215881624`*^9, 
   3.7311549480332985`*^9, 3.731255634809332*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n1D", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"4", " ", "nc", " ", "x0", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["y0", "2"]}], " ", 
          SuperscriptBox["z", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y"}], "+", "y0"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"y", "+", "y0"}], ")"}], " ", 
          SuperscriptBox["z0", "2"]}]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}], 
     RowBox[{"3", " ", 
      SuperscriptBox["y0", "3"], " ", 
      SuperscriptBox["z0", "3"]}]], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"z", "^", "2"}], "/", 
           RowBox[{"z0", "^", "2"}]}]}], "]"}]}], "*", "y0"}], ",", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"z", "^", "2"}], "/", 
          RowBox[{"z0", "^", "2"}]}]}], "]"}], "*", "y0"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7281516751374474`*^9, 3.7281516893171415`*^9}}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"nc", " ", "\[Pi]", " ", "x0", " ", "y0", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["z", "2"], "-", 
        SuperscriptBox["z0", "2"]}], ")"}], "2"]}], 
    RowBox[{"2", " ", 
     SuperscriptBox["z0", "4"]}]], ",", 
   RowBox[{
    RowBox[{"z", "<", "z0"}], "&&", 
    RowBox[{
     RowBox[{"z", "+", "z0"}], ">", "0"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.7281516961362877`*^9, 3.728151742848598*^9, 
  3.7286744263089433`*^9, 3.7311549530467463`*^9, 3.731255647391315*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TotalNumber", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"nc", " ", "\[Pi]", " ", "x0", " ", "y0", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["z", "2"], "-", 
         SuperscriptBox["z0", "2"]}], ")"}], "2"]}], 
     RowBox[{"2", " ", 
      SuperscriptBox["z0", "4"]}]], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", 
      RowBox[{"-", "z0"}], ",", "z0"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7286744406196365`*^9, 3.728674455463722*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["8", "15"], " ", "nc", " ", "\[Pi]", " ", "x0", " ", "y0", " ", 
  "z0"}]], "Output",
 CellChangeTimes->{3.7286744569581575`*^9, 3.7311549535376644`*^9, 
  3.731255649835215*^9}]
}, Open  ]],

Cell["\<\
Summary: for condensate fraction,
nc2d=nc3d*(4 x0/3)
nc1d=nc2d*(3 pi y0/8) = nc3d*(pi/2 x0 y0)
1D fit in z-direction amplitude has value nc*pi*x0*y0/2
Total Number = 1D fit amplitude*16/15*z0\
\>", "Text",
 CellChangeTimes->{{3.7281512165090904`*^9, 3.7281512499198165`*^9}, {
  3.7281514955555*^9, 3.728151501925453*^9}, {3.7317014483035254`*^9, 
  3.7317015006960692`*^9}}],

Cell["\<\
Simpler expressions
\
\>", "Text",
 CellChangeTimes->{{3.7311550182237673`*^9, 3.7311550219945197`*^9}}],

Cell[CellGroupData[{

Cell["Gaussian clouds", "Chapter",
 CellChangeTimes->{{3.728151269817771*^9, 3.728151271354865*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"n3dG", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"n0", "*", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"x", "^", "2"}]}], "/", 
      RowBox[{"x0", "^", "2"}]}], "-", 
     RowBox[{
      RowBox[{"y", "^", "2"}], "/", 
      RowBox[{"y0", "^", "2"}]}], "-", 
     RowBox[{
      RowBox[{"z", "^", "2"}], "/", 
      RowBox[{"z0", "^", "2"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7281513766881676`*^9, 3.7281514101512227`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n2dG", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"n3dG", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7281514119229345`*^9, 3.7281514371891737`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["y", "2"], 
      SuperscriptBox["y0", "2"]]}], "-", 
    FractionBox[
     SuperscriptBox["z", "2"], 
     SuperscriptBox["z0", "2"]]}]], " ", "n0", " ", 
  SqrtBox["\[Pi]"], " ", "x0"}]], "Output",
 CellChangeTimes->{{3.7281514279786644`*^9, 3.72815143798028*^9}, 
   3.7281517434191175`*^9, 3.7286744269591475`*^9, 3.7311549542179813`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n1dG", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{"n2dG", ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.728151439796153*^9, 3.7281514557986994`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox["z", "2"], 
     SuperscriptBox["z0", "2"]]}]], " ", "n0", " ", "\[Pi]", " ", "x0", " ", 
  "y0"}]], "Output",
 CellChangeTimes->{3.728151456573775*^9, 3.7281517438151703`*^9, 
  3.7286744274491463`*^9, 3.7311549547696643`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7286896351896315`*^9, 3.728689638561141*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["z", "2"], 
       SuperscriptBox["z0", "2"]]}]], " ", "n0", " ", "\[Pi]", " ", "x0", " ",
     "y0"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7281514305314555`*^9, 3.7281514318810625`*^9}, {
  3.728689641472665*^9, 3.7286896574103994`*^9}}],

Cell[BoxData[
 RowBox[{"n0", " ", 
  SuperscriptBox["\[Pi]", 
   RowBox[{"3", "/", "2"}]], " ", "x0", " ", "y0", " ", "z0"}]], "Output",
 CellChangeTimes->{{3.728689650603553*^9, 3.7286896583675594`*^9}, 
   3.7311549550308948`*^9}]
}, Open  ]],

Cell["\<\
Summary: for gaussian (thermal) fraction,
nc2d=nc3d*(sqrt(pi)*x0)
nc1d=nc3d*(pi*x0*y0)

The gaussian 3d:1d prefactor is related by pi*xt*yt, whereas the condensate \
3d:1d prefactor is pi/2*x0*y0\
\>", "Text",
 CellChangeTimes->{{3.728151508004632*^9, 3.728151566965538*^9}, {
  3.728164911837101*^9, 3.728164929660453*^9}}]
}, Open  ]]
},
WindowSize->{1280, 637},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 291, 7, 100, "Text"],
Cell[CellGroupData[{
Cell[874, 31, 314, 8, 30, "Input"],
Cell[1191, 41, 315, 8, 30, "Output"]
}, Open  ]],
Cell[1521, 52, 267, 3, 30, "Text"],
Cell[1791, 57, 521, 16, 30, "Input"],
Cell[2315, 75, 143, 2, 30, "Input"],
Cell[2461, 79, 158, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[2644, 85, 860, 26, 30, "Input"],
Cell[3507, 113, 1802, 56, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5346, 174, 1518, 46, 56, "Input"],
Cell[6867, 222, 789, 23, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7693, 250, 1280, 40, 56, "Input"],
Cell[8976, 292, 620, 17, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9633, 314, 561, 16, 54, "Input"],
Cell[10197, 332, 216, 5, 45, "Output"]
}, Open  ]],
Cell[10428, 340, 385, 9, 106, "Text"],
Cell[10816, 351, 114, 4, 49, "Text"],
Cell[CellGroupData[{
Cell[10955, 359, 100, 1, 72, "Chapter"],
Cell[11058, 362, 544, 17, 30, "Input"],
Cell[CellGroupData[{
Cell[11627, 383, 348, 9, 30, "Input"],
Cell[11978, 394, 472, 13, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12487, 412, 280, 7, 30, "Input"],
Cell[12770, 421, 342, 9, 44, "Output"]
}, Open  ]],
Cell[13127, 433, 94, 1, 30, "Input"],
Cell[CellGroupData[{
Cell[13246, 438, 511, 14, 53, "Input"],
Cell[13760, 454, 232, 5, 30, "Output"]
}, Open  ]],
Cell[14007, 462, 334, 9, 106, "Text"]
}, Open  ]]
}
]
*)

