\documentclass{article}
\usepackage{physics}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{framed}
\usepackage{authblk}
\usepackage{empheq}
\usepackage{amsfonts}
\usepackage{esint}
\usepackage[makeroom]{cancel}
\usepackage{dsfont}
\usepackage{centernot}
\usepackage{mathtools}
\usepackage{subcaption}
\usepackage{bigints}
\usepackage{amsthm}
\theoremstyle{definition}
\newtheorem{lemma}{Lemma}
\newtheorem{defn}{Definition}[section]
\newtheorem{prop}{Proposition}[section]
\newtheorem{rmk}{Remark}[section]
\newtheorem{thm}{Theorem}[section]
\newtheorem{exmp}{Example}[section]
\newtheorem{prob}{Problem}[section]
\newtheorem{sln}{Solution}[section]
\newtheorem*{prob*}{Problem}
\newtheorem{exer}{Exercise}[section]
\newtheorem*{exer*}{Exercise}
\newtheorem*{sln*}{Solution}
\usepackage{empheq}
\usepackage{tensor}
\usepackage{xcolor}
%\definecolor{colby}{rgb}{0.0, 0.0, 0.5}
\definecolor{MIT}{RGB}{163, 31, 52}
\usepackage[pdftex]{hyperref}
%\hypersetup{colorlinks,urlcolor=colby}
\hypersetup{colorlinks,linkcolor={MIT},citecolor={MIT},urlcolor={MIT}}  
\usepackage[left=1in,right=1in,top=1in,bottom=1in]{geometry}

\usepackage{newpxtext,newpxmath}
\newcommand*\widefbox[1]{\fbox{\hspace{2em}#1\hspace{2em}}}

\newcommand{\p}{\partial}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\lag}{\mathcal{L}}
\newcommand{\nn}{\nonumber}
\newcommand{\ham}{\mathcal{H}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\I}{\mathcal{I}}
\newcommand{\K}{\mathcal{K}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\w}{\omega}
\newcommand{\lam}{\lambda}
\newcommand{\al}{\alpha}
\newcommand{\be}{\beta}
\newcommand{\x}{\xi}

\newcommand{\G}{\mathcal{G}}

\newcommand{\f}[2]{\frac{#1}{#2}}

\newcommand{\ift}{\infty}

\newcommand{\lp}{\left(}
\newcommand{\rp}{\right)}

\newcommand{\lb}{\left[}
\newcommand{\rb}{\right]}

\newcommand{\lc}{\left\{}
\newcommand{\rc}{\right\}}


\newcommand{\V}{\mathbf{V}}
\newcommand{\U}{\mathcal{U}}
\newcommand{\Id}{\mathcal{I}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\Z}{\mathcal{Z}}

%\setcounter{chapter}{-1}


\usepackage{enumitem}



\usepackage{listings}
\captionsetup[lstlisting]{margin=0cm,format=hang,font=small,format=plain,labelfont={bf,up},textfont={it}}
\renewcommand*{\lstlistingname}{Code \textcolor{violet}{\textsl{Mathematica}}}
\definecolor{gris245}{RGB}{245,245,245}
\definecolor{olive}{RGB}{50,140,50}
\definecolor{brun}{RGB}{175,100,80}

%\hypersetup{colorlinks,urlcolor=colby}
\lstset{
	tabsize=4,
	frame=single,
	language=mathematica,
	basicstyle=\scriptsize\ttfamily,
	keywordstyle=\color{black},
	backgroundcolor=\color{gris245},
	commentstyle=\color{gray},
	showstringspaces=false,
	emph={
		r1,
		r2,
		epsilon,epsilon_,
		Newton,Newton_
	},emphstyle={\color{olive}},
	emph={[2]
		L,
		CouleurCourbe,
		PotentielEffectif,
		IdCourbe,
		Courbe
	},emphstyle={[2]\color{blue}},
	emph={[3]r,r_,n,n_},emphstyle={[3]\color{magenta}}
}






\begin{document}
\begin{framed}
\noindent Name: \textbf{Huan Q. Bui}\\
Course: \textbf{8.422 - AMO II}\\
Problem set: \textbf{\#3}\\
Due: Friday, Mar 3, 2022.
\end{framed}
	
	
\noindent \textbf{1. Classical Coherence of Light.} \\

\noindent Consider a classical light field. The classical expressions for first-order and second-order coherence are:
\begin{align*}
g^{(1)}(\tau) &= \f{\langle E^*(t) E (t+\tau)\rangle}{\langle E^*(t) E(t) \rangle} \\
g^{(2)}(\tau) &= \f{\langle I(t) I (t+\tau) \rangle }{\langle I(t) \rangle^2} 
= \f{\langle  E^*(t) E^*(t+\tau) E(t+\tau) E(t)   \rangle }{\langle E^*(t) E(t) \rangle^2}
\end{align*}
where $\langle \cdot \rangle$ denotes a statistical averaging over many measurements, which can be interpreted as a time average. Moreover, $\langle f^*(t) g(t)\rangle$ defines a scalar product. 

\begin{enumerate}[label=\alph*)]

\item Here we show that $\vert g^{(1)}(\tau) \vert \leq 1$. In view of Cauchy's inequality, and the fact that $\langle E^*(t+\tau) E(t+\tau)\rangle = \langle E^*(t) E(t) \rangle $
\begin{align*}
\vert g^{(1)}(\tau)\vert^2 = \f{\vert \langle E^*(t) E (t+\tau)\rangle \vert^2}{\vert \langle E^*(t) E(t) \rangle\vert^2} 
\leq \f{ \langle E^*(t) E(t) \rangle \langle E^*(t+\tau) E(t+\tau) \rangle }{\vert \langle E^*(t) E(t) \rangle \vert^2}
= \f{ \langle E^*(t) E(t) \rangle \langle E^*(t) E(t) \rangle }{\vert \langle E^*(t) E(t) \rangle \vert^2} = 1.
\end{align*}
So, $\vert g^{(1)}(\tau)  \vert \leq 1$ as desired. 


\item Here we show that for zero time-delay, the second-order coherence obeys $g^{(2)}(0) \geq 1$. To this end, we notice that
\begin{align*}
0 \leq \langle [I(t) - \langle I(t) \rangle]^2 \rangle = \langle I(t)^2 - 2I(t) \langle I(t) \rangle + \langle I(t) \rangle^2 \rangle = \langle I(t)^2 \rangle -2 \langle I(t)\rangle^2 + \langle I(t) \rangle^2 = \langle I(t)^2 \rangle - \langle I(t)\rangle^2. 
\end{align*}

Thus, for $\tau=0$, we have
\begin{align*}
g^{(2)}(0) =  \f{\langle I(t)^2 \rangle}{\langle I(t) \rangle^2} \geq  \f{ \langle   I(t)  \rangle^2 }{\langle I(t) \rangle^2} = 1,
\end{align*}
as desired. This implies that light in a number state, which has $g^{(2)}(0) < 1$, has no classical analog.

\item Here we show that $g^{(2)}(\tau) \leq g^{(2)}(0)$. Viewing $\langle I(t) I(t+\tau) \rangle$ as the inner product $\langle I(t), I(t+\tau) \rangle$ (which is possible since intensities are real numbers), we see immediately that $\langle I(t) I(t+\tau) \rangle \leq \langle I(t) I(t) \rangle$, which gives
\begin{align*}
g^{(2)}(\tau) =  \f{\langle I(t) I (t+\tau) \rangle }{\langle I(t) \rangle^2}  \leq  \f{\langle I(t) I (t) \rangle }{\langle I(t) \rangle^2} = g^{(2)}(0).
\end{align*}

This implies that anti-bunched light, which has $g^{(2)}(\tau) > g^{(2)}(0)$, has no classical analog.

\item Consider chaotic classical light generated by an ensemble of $\nu$ atoms. The total electric field can be expressed as $E(t) = \sum^\nu_{i=1} E_i(t)$, where the phases of $E_i$ are random. Here we show that when $\nu$ is large, 
\begin{align*}
g^{(2)}(\tau) = 1 + \vert g^{(1)} (\tau)\vert ^2.
\end{align*}

Let's first look at the numerator of the definition of $g^{(2)}(\tau)$:
\begin{align*}
\langle  E^*(t) E^*(t+\tau) E(t+\tau) E(t) \rangle 
&= \bigg\langle \sum_{i=1}^\nu E_i^*(t) \sum_{j=1}^\nu E_j^*(t+\tau) \sum_{k=1}^\nu E_k(t+\tau) \sum_{l=1}^\nu E_l(t) \bigg\rangle.
\end{align*}
Since statistical averages in which the random electric field phases do not cancel are zero and fields emitted by different atoms are uncorrelated, the only terms that remain are those with pairs of fields from the \textit{same} atoms. This means we're reduced to summation over two indices $i,j$. We can break the summation down further into the $i=j$ part and $i\neq j$ part. The result is:
\begin{align*}
\langle  E^*(t) E^*(t+\tau) E(t+\tau) E(t) \rangle 
&= \sum_{i=1}^\nu \langle  E_i^*(t) E_i^*(t+\tau) E_i(t+\tau) E_i(t) \rangle  \\
&\quad + \sum_{i\neq j}\lb 
\langle E_i^*(t) E_j^*(t+\tau) E_i(t+\tau) E_j(t) \rangle + 
\langle E_i^*(t) E_j^*(t+\tau) E_j(t+\tau) E_i(t) \rangle 
\rb.
\end{align*}
The first sum has $\nu$ summands, while the second sum has $\nu(\nu - 1)$ summands. Since each atom contributes equally, we find that 
\begin{align*}
\langle  E^*(t) E^*(t+\tau) E(t+\tau) E(t) \rangle 
&= \nu \langle  E_i^*(t) E_i^*(t+\tau) E_i(t+\tau) E_i(t) \rangle  \\
&\quad + \nu(\nu-1) \lb 
\vert \langle E_i^*(t) E_i(t+\tau)  \rangle \vert ^2
+
 \langle E_i^*(t) E_i(t) \rangle^2 \rb.
\end{align*}
For $\nu \gg 1$, we have $\nu(\nu-1) \approx \nu^2 \gg \nu$, so we find that
\begin{align*}
\langle  E^*(t) E^*(t+\tau) E(t+\tau) E(t) \rangle = 
 \nu^2 \lb 
  \vert \langle E_i^*(t) E_i(t+\tau)  \rangle \vert ^2
  +
 \langle E_i^*(t) E_i(t) \rangle^2 \rb.
\end{align*}
Next, let us look at the numerator of $\vert g^{(1)}(\tau)\vert^2$:
\begin{align*}
\vert \langle E^*(t) E(t+\tau) \rangle \vert^2 
= 
\bigg\vert \bigg\langle  \sum_{i=1}^\nu E^*_i(t)  \sum_{j=1}^\nu E_i(t+\tau) \bigg\rangle \bigg\vert^2
=
\bigg\vert \sum_{i=1}^\nu \langle E_i^*(t) E_i(t+\tau)  \rangle \bigg\vert^2
=
\nu^2 \vert \langle E_i^*(t) E_i(t+\tau) \rangle \vert^2.
\end{align*}
Finally, let us look at the denominator:
\begin{align*}
\langle E^*(t) E(t) \rangle^2 
= \bigg\langle \sum_{i=1}^\nu E_i^*(t) \sum_{j=1}^\nu E_j(t)  \bigg\rangle^2
= \lp \sum_{i=1}^\nu \langle E_i^*(t) E_i(t) \rangle \rp^2 = \nu^2 \langle E_i^*(t) E_i(t) \rangle^2 = \nu^2 \vert\langle E_i^*(t) E_i(t) \rangle \vert^2.
\end{align*}
Putting everything together, we find that for $\nu \gg 1$,
\begin{align*}
g^{(2)}(\tau) - \lp 1 +\vert g^{(1)}(\tau) \vert^2 \rp
&= 
\f{ \nu^2 \lb 
  \vert \langle E_i^*(t) E_i(t+\tau)  \rangle \vert ^2
  +
 \langle E_i^*(t) E_i(t) \rangle^2 \rb}
 {\nu^2 \langle E_i^*(t) E_i(t)  \rangle^2} 
 -
 \f {\nu^2 \langle E_i^*(t) E_i(t)  \rangle^2 + \nu^2 \vert \langle E_i^*(t) E_i(t+\tau) \rangle \vert^2} 
 {\nu^2 \vert \langle E_i^*(t) E_i(t)  \rangle \vert^2} \\
 &= 0,
\end{align*}
as desired. 
\end{enumerate}





\noindent \textbf{2. Quantum Coherence of Light.}\\

\noindent Consider light in a single mode of the radiation field. The quantum mechanical expressions for
first-order and second-order coherence are
\begin{align*}
g^{(1)}(\mathbf{r}_1, t_1, \mathbf{r}_2, t_2) 
&= \f{\langle \hat{E}^-(\mathbf{r}_1, t_1)  \hat{E}^+(\mathbf{r}_2, t_2) \rangle }{ 
\langle \hat{E}^-(\mathbf{r}_1, t_1) \hat{E}^+(\mathbf{r}_1, t_1) \rangle^{1/2}   
\langle \hat{E}^-(\mathbf{r}_2, t_2) \hat{E}^+(\mathbf{r}_2, t_2)\rangle^{1/2}} \\
g^{(2)}(\mathbf{r}_1, t_1, \mathbf{r}_2, t_2 ; \mathbf{r}_2, t_2, \mathbf{r}_1, t_1) 
&= \f{\langle \hat{E}^-(\mathbf{r}_1, t_1) \hat{E}^-(\mathbf{r}_2, t_2) \hat{E}^+(\mathbf{r}_2, t_2) \hat{E}^+(\mathbf{r}_1, t_1)  \rangle }{
\langle \hat{E}^-(\mathbf{r}_1, t_1) \hat{E}^+(\mathbf{r}_1, t_1) \rangle 
\langle \hat{E}^-(\mathbf{r}_2, t_2) \hat{E}^+(\mathbf{r}_2, t_2)\rangle}
\end{align*}
where
\begin{align*}
\hat{E}^+(\mathbf{r},t) &= 
i \sqrt{ \f{\hbar \omega}{2 \epsilon_0 V} } a e^{-i(\omega t - \mathbf{k} \cdot \mathbf{r})} \\
\hat{E}^-(\mathbf{r},t) &= 
- i \sqrt{ \f{\hbar \omega}{2 \epsilon_0 V} } a^\dagger e^{+i(\omega t - \mathbf{k} \cdot \mathbf{r})} 
\end{align*}


\begin{enumerate}[label=\alph*)]

\item Here we show that 
\begin{align*}
g^{(2)}(0) = \f{\langle a^\dagger a^\dagger a a  \rangle}{\langle a^\dagger a  \rangle^2}   = \f{\langle n^2 \rangle - \langle n  \rangle}{\langle n \rangle^2}.
\end{align*}
By inspection, the normalization factors $\sqrt{\hbar \omega / 2\epsilon_0 V}$ in the numerator and denominator cancel. Also, since $i$ always appears with $-i$, these also cancel to unity. Since $t = 0$, we ignore factors of $e^{\pm i\omega t}$ everywhere. Finally, every instance of $e^{ \pm i\vec{k}\cdot \vec{r}_i}$ is accompanied by an instance of $e^{\mp i \vec{k} \cdot \vec{r}_i}$, so these cancel as well. In the end we're left with
\begin{align*}
g^{(2)}(0) = \f{\langle a^\dagger a^\dagger a a \rangle }{\langle a^\dagger a \rangle^2}.
\end{align*}
Next, since $a^\dagger a  = n$ and
\begin{align*}
\langle a^\dagger a^\dagger a a \rangle = \langle a^\dagger (aa^\dagger - 1) a \rangle = \langle a^\dagger a a^\dagger a   - a^\dagger a  \rangle = \langle n^2 \rangle - \langle n \rangle,
\end{align*}
we have
\begin{align*}
g^{(2)}(0) = \f{\langle a^\dagger a^\dagger a a  \rangle}{\langle a^\dagger a  \rangle^2}   = \f{\langle n^2 \rangle - \langle n  \rangle}{\langle n \rangle^2},
\end{align*}
as desired. 



\item Next we show that for number states of light $\ket{n}$ where $n > 2$, 
\begin{align*}
\vert g^{(1)} \vert = 1 \quad\quad g^{(2)} = 1 - \f{1}{n}
\end{align*}
independent of space-time separation. Note that the normalization constant cancel, and so by definition
\begin{align*}
\vert g^{(1)}\vert = \f{  \abs{ \bra{n}  a^\dagger a \ket{n}  } 
\abs{ e^{i(k\omega t_1 - \mathbf{k} \cdot \mathbf{r}_1)}  e^{-i(\omega t_2 - \mathbf{k}\cdot \mathbf{r}_2)} }  
}{\abs{\bra{n} a^\dagger a \ket{n}^{1/2} \bra{n} a^\dagger a \ket{n}^{1/2}}} = 1,
\end{align*}
as desired. For $g^{(2)}$, it is clear from the definition that for $\ket{n}$ with $n>2$
\begin{align*}
g^{(2)} = \f{\bra{n}  a^\dagger a^\dagger a a   \ket{n}}{ \bra{n}  a^\dagger a   \ket{n}^2 } = \f{n^2 - n}{n^2} = 1 - \f{1}{n},
\end{align*}
as desired. Note that the expression above is true for $n\geq 1$. So the results for $n=1$ follow trivially:
\begin{align*}
\vert g_{n=1}^{(1)}\vert &= 1 \\
g_{n=1}^{(2)} &= 0.
\end{align*}
Equivalently, we note that we have $...aa\ket{1}$ in the numerator, which makes $g^{(2)}_{n=1}$ zero. 

\noindent For $n=0$, the expressions we found above might not be defined anymore. However, we could argue what they should be. For $\vert g^{(1)} \vert$, we can take the $n\to 0$ "limit" to get
\begin{align*}
\vert g_{n=0}^{(1)}  \vert = 1.
\end{align*}
What about $g_{n=0}^{(2)}$? Viewing the vacuum state $\ket{0}$ as the coherent state $\ket{\al = 0}$, we see from Part (c) that $g^{(2)}_{n=0} = 1$. Viewing the vacuum state $\ket{0}$ as the $\langle n \rangle \to 0$ of chaotic light, we see from Part (d) that $g^{(2)}_{n=0} = 0$. Viewing the vacuum state as the number state $\ket{n=0}$, it is not clear what $g^{(2)}$ should be. From these, we conclude that $g^{(2)}$ for the vacuum state is not defined. 



\item Consider a coherent state $\ket{\al}$, we show that $\vert g^{(1)} \vert = \vert g^{(2)} \vert = 1$
\begin{align*}
\vert g^{(1)}_{\ket{\al}} \vert =  \f{\abs{\bra{\al} a^\dagger a \ket{\al}} 
\abs{ e^{i(k\omega t_1 - \mathbf{k} \cdot \mathbf{r}_1)}  e^{-i(\omega t_2 - \mathbf{k}\cdot \mathbf{r}_2)} }  
}{ \bra{\al} a^\dagger a \ket{\al}^{1/2}  \bra{\al} a^\dagger a \ket{\al}^{1/2} } 
= 
1
\end{align*}
\begin{align*}
\vert g^{(2)}_{\ket{\al}} \vert =  \f{ \bra{\al}  a^\dagger a^\dagger a a \ket{\al} }{ \bra{\al} a^\dagger a \ket{\al}^2 } = 
\f{\abs{\al}^4}{\abs{\al}^4}  = 1.
\end{align*} 

\item Finally, consider chaotic light with density matrix
\begin{align*}
\hat{\rho} = \lp  1 - e^{-\hbar \omega / k_B T} \rp \sum_n e^{-n\hbar \omega / k_B T} \ketbra{n}.
\end{align*}
Here we show that $\vert g^{(1)} \vert = 1$ and $\vert g^{(2)} \vert = 2$. We first calculate:
\begin{align*}
\Tr(\hat{\rho}  a^\dagger a ) = \lp  1 - e^{-\hbar \omega / k_B T} \rp \sum_{n} e^{-n\hbar \omega /k_B T} \Tr(\ketbra{n} a^\dagger a ) = \lp  1 - e^{-\hbar \omega / k_B T} \rp \sum_n n e^{-n\hbar \omega/k_B T}. 
\end{align*}
From the definition of $g^{(1)}$ (in the slides) we have that
\begin{align*}
\vert g^{(1)}\vert = \f{\Tr(\hat{\rho} a^\dagger a )}{\sqrt{\Tr(\hat{\rho} a^\dagger a )}  \sqrt{\Tr(\hat{\rho} a^\dagger a )} } = 1,
\end{align*}
as desired. To find $g^{(2)}$, we need to calculate
\begin{align*}
\Tr(\hat{\rho} a^\dagger a^\dagger a a ) = \Tr(\hat{\rho}[n^2 - n]) = \lp 1 - e^{-\hbar \omega/k_B T} \rp \sum_n (n^2 - n) e^{-n\hbar \omega / k_B T}. 
\end{align*}
From the definition of $g^{(2)}$ in the slides, we find 
\begin{align*}
g^{(2)} = \f{1}{1 - e^{-\hbar \omega /k_B T}} \f{\sum_n (n^2 - n) e^{-n\hbar \omega / k_B T} }{\lp \sum_n n e^{-n\hbar \omega / k_B T} \rp^2}.
\end{align*}
With
\begin{align*}
\sum_n n e^{-n \hbar \omega / k_BT} = -\p_{\hbar \omega/k_B T} \sum_{n}e^{-n\hbar \omega / k_B T} = -\p_{\hbar \omega / k_B T} \f{1}{1 - e^{-\hbar \omega / k_BT}} 
\end{align*}
and 
\begin{align*}
\sum_{n} n^2 e^{-n \hbar \omega / k_B T} 
= \p^2_{\hbar \omega / k_BT} e^{-n\hbar \omega/k_BT} 
= \p^2_{\hbar \omega / k_BT} \f{1}{1 - e^{-\hbar \omega / k_BT}},
\end{align*}
we can simplify the expression above for $g^{(2)}$ in Mathematica (or by remembering hyperbolic trig identities) to get
\begin{align*}
g^{(2)} = 2,
\end{align*}
as desired. Mathematica code:

\begin{lstlisting}
In[15]:= X = (-D[1/(1 - Exp[-\[Beta]]), \[Beta]])^2 // FullSimplify;

In[14]:= 
Y = D[1/(1 - Exp[-\[Beta]]), {\[Beta], 2}] + 
    D[1/(1 - Exp[-\[Beta]]), \[Beta]] // FullSimplify;

In[16]:= (Y/X)/(1 - Exp[-\[Beta]]) // FullSimplify

Out[16]= 2
\end{lstlisting}

\item Consider the states
\begin{align*}
\ket{\psi_\pm} = \f{\ket{\al} \pm  \ket{-\al}}{ \sqrt{2}  \sqrt{1 \pm e^{-2\abs{\al}^2}}}.
\end{align*}
We will compute $g^{(2)} (\tau)$ for these states as a function of $\al$. For $\ket{\psi_+}$, we have
\begin{align*}
g^{(2)}_+ = \f{\langle a^\dagger a^\dagger a a \rangle}{ \langle a^\dagger a \rangle^2} = 
\f{2\abs{\al}^4 \lp 1 + e^{-2\abs{\al}^2}\rp }{  4 \abs{\al}^4 \lp 1 - e^{-2\abs{\al}^2}\rp^2 } \times \underbrace{2\lp 1 + e^{-2\abs{\al}^2} \rp}_{\text{norm.}} = 
\lp \f{1 + e^{-2\abs{\al}^2}}{ 1 - e^{-2\abs{\al}^2} }\rp^2.
\end{align*}
For $\ket{\psi_-}$ we have
\begin{align*}
g^{(2)}_- = \f{\langle a^\dagger a^\dagger a a \rangle}{ \langle a^\dagger a \rangle^2}
= \f{2\abs{\al}^4\lp  1- e^{-2\abs{\al}^2}\rp}{4\abs{\al}^4\lp 1 + e^{-2\abs{\al}^2} \rp^2} \times \underbrace{2\lp 1 - e^{-2\abs{\al}^2}\rp }_{\text{norm}} =  \lp \f{1 - e^{-2\abs{\al}^2}}{1 + e^{-2\abs{\al}^2}} \rp^2.
\end{align*}
Notice that $g_+^{(2)}(0) > 1$ whereas $g^{(2)}_-(0) < 1$, which means $\ket{\psi_-}$ shows non-classical second-order coherence. 
\end{enumerate}



\noindent \textbf{3. The Quantum Beamsplitter.}\\

\noindent Let the beamsplitter operator $B$, acting with angle $\theta$ on modes $a$ and $b$, by defined by 
\begin{align*}
B = \exp\lb \theta \lp a^\dagger b - a b^\dagger \rp \rb .
\end{align*}

\begin{enumerate}[label=\alph*)]

\item To show that $B$ conservers photon number, we will show that $B$ leaves $n_a + n_b$ unchanged. To this end, it suffices to show that $[a^\dagger b - a b^\dagger , n_a + n_b] = [a^\dagger b - ab^\dagger, a^\dagger a + b^\dagger b] = 0$:
\begin{align*}
[a^\dagger b - ab^\dagger, a^\dagger a + b^\dagger b]
&= (a^\dagger b - ab^\dagger)(a^\dagger a + b^\dagger b) - (a^\dagger a + b^\dagger b)(a^\dagger b - ab^\dagger) \\
&= a^\dagger a^\dagger ab + a^\dagger bb^\dagger b - aa^\dagger ab^\dagger -ab^\dagger b^\dagger b - a^\dagger a a^\dagger b + a^\dagger a a b^\dagger - b^\dagger b a^\dagger b \\
&= a^\dagger [a^\dagger , a] b + a^\dagger [b,b^\dagger] b - ab^\dagger [b^\dagger ,b] - [a,a^\dagger] ab^\dagger  \\
&= -a^\dagger b + a^\dagger b + ab^\dagger -ab^\dagger \\
&= 0.
\end{align*}
Therefore,
\begin{align*}
B (n_a+n_b) B^\dagger = (n_a + n_b) BB^\dagger = n_a + n_b,
\end{align*}
as desired. It is not difficult to see why $B$ is unitary, i.e. $B B^\dagger = \mathbb{I}$: Let $a^\dagger b -ab^\dagger = \mathcal{O}$, then 
\begin{align*}
BB^\dagger = \exp{\theta \mathcal{O}}\exp{\theta^*\mathcal{O}^\dagger} =  \exp{\theta \mathcal{O}}\exp{-\theta^*\mathcal{O}} = \exp{(\theta - \theta^*)\mathcal{O}} = \mathbb{I}
\end{align*}
since $\mathcal{O}^\dagger = -\mathcal{O}$ and $\theta \in \mathbb{R}$.



\item Let $\ket{\al}$ be a coherent state. Here we compute $B \ket{\al}_a \ket{0}_b $. In order to do this, we must first know how $a,b$ are transformed under $B$. In view of the identity:
\begin{align*}
e^{\mathcal{A}}  \mathcal{M} e^{-\mathcal{A}} = \sum_{n=0}^\infty \f{1}{n!} \mathcal{A}^n \{ \mathcal{M} \}
\end{align*}
where 
\begin{align*}
\mathcal{A}^0 \{ \mathcal{M} \}= \mathcal{M}, \quad \mathcal{A}^1 \{ \mathcal{M} \} = [\mathcal{A}, \mathcal{M}], \quad \mathcal{A}^2 \{ \mathcal{M} \} = [\mathcal{A}, [\mathcal{A}, \mathcal{M}]], \quad \dots,
\end{align*}
we compute, using the fact that $[\mathcal{O},a] = -b$ and $[\mathcal{O},b] = a$,
\begin{align*}
B a B^\dagger 
&= \exp\lb \theta\lp a^\dagger b -ab^\dagger \rp \rb   a \exp\lb -\theta \lp a^\dagger b - ab^\dagger \rp \rb \\
&= a + \theta[ \mathcal{O},a] + \f{\theta}{2!}[\mathcal{O}, [\mathcal{O}, a]] + \dots \\
&= a - \theta b + \f{\theta^2}{2!} a + \dots \\
&= a\lp 1 - \f{\theta^2}{2!} + \f{\theta^4}{4!} \rp - b \lp \theta - \f{\theta^3}{3!} + \dots \rp \\
&= a\cos\theta - b\sin\theta
\end{align*}
\begin{align*}
B b B^\dagger 
&= \exp\lb \theta\lp a^\dagger b -ab^\dagger \rp \rb   b \exp\lb -\theta \lp a^\dagger b - ab^\dagger \rp \rb \\
&= b + \theta[ \mathcal{O},b] + \f{\theta}{2!}[\mathcal{O}, [\mathcal{O}, b]] + \dots \\
&= b + \theta a - \f{\theta^2}{2!} b + \dots \\
&= b\lp 1 - \f{\theta^2}{2!} + \f{\theta^4}{4!} \rp + a \lp \theta - \f{\theta^3}{3!} + \dots \rp \\
&= a\sin\theta + b\cos\theta.
\end{align*}
With these, we have
\begin{align*}
B a^\dagger B^\dagger &= a^\dagger \cos\theta - b^\dagger \sin\theta \\
B b^\dagger B^\dagger &= a^\dagger \sin\theta + b^\dagger \cos\theta.
\end{align*}
With these we can now calculate what happens to coherent state inputs. Consider the case where the input is $\ket{\al}_a \ket{\be}_b$. Using the fact that $B^\dagger \ket{0}_a\ket{0}_b = \ket{0}_a \ket{0}_b$. We have
\begin{align*}
B \ket{\al}_a \ket{\be}_b
&= \exp\lp -\f{\abs{\al}^2 + \abs{\be}^2}{2} \rp B \exp\lp \al a^\dagger + \be b^\dagger \rp B^\dagger \ket{0}_a \ket{0}_b \\
&= \exp\lp -\f{\abs{\al}^2 + \abs{\be}^2}{2} \rp \exp\lb B \lp \al a^\dagger + \be b^\dagger \rp B^\dagger \rb  \ket{0}_a \ket{0}_b \\
&= \exp\lp -\f{\abs{\al}^2 + \abs{\be}^2}{2} \rp  \exp\lb \al Ba^\dagger B^\dagger  + \be B b^\dagger B^\dagger \rb \ket{0}_a \ket{0}_b \\
&= \exp\lp -\f{\abs{\al}^2 + \abs{\be}^2}{2} \rp 
\exp\lb a^\dagger(\al\cos\theta + \be\sin\theta) + b^\dagger (\be \cos\theta - \al\sin\theta) \rb \ket{0}_a \ket{0}_b \\
&= \ket{\al(\cos\theta + \be\sin\theta)}_{a'} \ket{ \be\cos\theta -\al\sin\theta }_{b'}.
\end{align*}
From here, we see that the output is a tensor product of coherent states for all $\theta$. For the case where $\be  =0$, we find 
\begin{align*}
B\ket{\al}_a \ket{0}_b = \ket{\al\cos\theta}_{a'} \ket{-\al\sin\theta }_{b'}.
\end{align*}
Physically, a coherent state with amplitude $\al$ enters port $a$ of the beamsplitter and gets coupled to the vacuum from port $b$. The amplitude of the coherent leaving port $a$ is $\al\cos\theta$, which means the transmission coefficient is $\cos^2\theta$ and the reflection coefficient is $\sin^2\theta$.

\item There is close connection between the Lie group $SU(2)$ and the algebra of two coupled harmonic oscillators, which is useful for understanding $B$. Define
\begin{align*}
s_z = a^\dagger a - b^\dagger b \quad\quad s_+ = a^\dagger b \quad\quad s_- = a b^\dagger, 
\end{align*}
and let $s_\pm = (s_x \pm i s_y)/2$. Under these definitions, we have
\begin{align*}
B(\theta) = \exp\lb \theta\lp a^\dagger b - ab^\dagger \rp \rb = \exp\lb \theta(s_+ - s_-) \rb = \exp(-i \sqrt{2} \theta s_y),
\end{align*}
which is a rotation abound $y$ in the given spin space. \\

\noindent What is $n_a + n_b$? To find this, we calculate:
\begin{align*}
s_x^2 + s_y^2 + s_z^2 
&= (a^\dagger a)^2 + (b^\dagger b)^2 - 2a^\dagger a b^\dagger b + 2a^\dagger a bb^\dagger + 2 aa^\dagger b^\dagger b  \\
&=  (a^\dagger a)^2 + (b^\dagger b)^2 + 2a^\dagger a b^\dagger b + 2a^\dagger a + 2b^\dagger b \\
&= (a^\dagger a + b^\dagger b) ( a^\dagger a + b^\dagger b + 2).
\end{align*}
By choosing an appropriate normalization factor for the $s_i$ operators, which is $1/2$, we find 
\begin{align*}
\Sigma_x^2 + \Sigma_y^2 + \Sigma_z^2 = \f{1}{4}(s_x^2 + s_y^2 + s_z^2) = \f{1}{4} (a^\dagger a + b^\dagger b) ( a^\dagger a + b^\dagger b + 2) \equiv n' (n'+1),
\end{align*}
where $n' = (a^\dagger a + b^\dagger b)/2$. We see that, up to some normalization factor , the quantity $a^\dagger a + b^\dagger b = n_a + n_b$ is equivalent to the spin quantum number in the spin space parameterized by $s_x, s_y, s_z$. \\


\noindent We now show that $s_x, s_y, s_z$ have the same commutation relations as Pauli matrices. To this end, we simply compute:
\begin{align*}
[s_x, s_x] &= [s_y, s_y] = [s_z, s_z] = 0\\
[s_x, s_y] &= -i (aa^\dagger b^\dagger b - a^\dagger a bb^\dagger) = -i [ (1 + a^\dagger a)b^\dagger b - a^\dagger a(1+b^\dagger b)  ] = i( a^\dagger a - b^\dagger b ) = i s_z  \\
[s_y, s_z] &= \f{i}{2} ( a^\dagger [a,a^\dagger] b + [a,a^\dagger]ab^\dagger + a^\dagger [b,b^\dagger] b + ab^\dagger [b,b^\dagger]) =  i ( a^\dagger b + ab^\dagger) =  i s_x \\
[s_z, s_x] &= \f{1}{2} (a^\dagger [a,a^\dagger] b - [a,a^\dagger] ab^\dagger - a^\dagger [b^\dagger,b] b - ab^\dagger[b,b^\dagger]) = a^\dagger b - ab^\dagger =  is_y
\end{align*}
Similar to results expected from Pauli matrices. Note that we don't have quite exactly the Pauli matrix commutation relations because of the normalization factor, as mentioned. To get the familiar results with factors of $2$ at the right places, we could use the set $\{ \Sigma_x, \Sigma_y, \Sigma_z \}$ defined above. 

\item Here we look at how a beamsplitter transforms an input of a photon-number eigenstate. Let 
\begin{align*}
B(\theta) = \exp\lb \theta \lp -a^\dagger b + ab^\dagger  \rp\rb,
\end{align*}
and $B = B(\pi/4)$ be a 50/50 beamsplitter, such that
\begin{align*}
BaB^\dagger = \f{a+b}{\sqrt{2}} \quad\quad  BbB^\dagger = \f{-a + b}{\sqrt{2}}.
\end{align*}
From Part (b), we also have that
\begin{align*}
Ba^\dagger B^\dagger = \f{a^\dagger + b^\dagger}{\sqrt{2}} \quad\quad Bb^\dagger B^\dagger = \f{-a^\dagger + b^\dagger}{\sqrt{2}}.
\end{align*}
Note that the relations are slightly different here because $\theta \to -\theta$.

Let us compute $B\ket{0}_b\ket{n}_a$:
\begin{align*}
B\ket{n}_a \ket{0}_b 
&= B \f{(a^\dagger)^n}{\sqrt{n!}} \ket{0}_{a}\ket{0}_{b} \\
&= B \f{(a^\dagger)^n}{\sqrt{n!}} B^\dagger \ket{0}_{a}\ket{0}_{b} \\
&= \f{1}{\sqrt{n!}} (B a^\dagger B^\dagger)^n \ket{0}_a \ket{0}_b \\
&= \f{1}{2^{n/2} \sqrt{n!} } \lp a^\dagger + b^\dagger \rp^n \ket{0}_a \ket{0}_b \\
&= \f{1}{2^{n/2} \sqrt{n!}} \sum_{k=0}^n  {n\choose{k }} (a^\dagger)^{n-k} (b^\dagger)^{k} \ket{0}_a \ket{0}_b \\
&= \f{1}{2^{n/2} \sqrt{n!}} \sum_{k=0}^n {n\choose{k }}  \sqrt{(n-k)! k! }  \ket{n-k}_{a'} \ket{k}_{b'} \\
&= \f{1}{2^{n/2}} \sum_{k=0}^n  {n \choose{k}}^{1/2} \ket{n-k}_{a'} \ket{k}_{b'}.
\end{align*}
Note that the result is not $\ket{n/2}\ket{n/2}$ since $\ket{n}$ is a number state and is not a coherent state. \\

Note that all amplitudes are real. The photon number states with the maximal amplitudes are those with $k = \lfloor{n/2} \rfloor$ and $\lceil{n/2} \rceil$: 
\begin{align*}
\ket{n - \lfloor{n/2}\rfloor}_{a'} \ket{\lfloor{n/2}\rfloor } 
\quad \text{and} \quad 
\ket{n - \lceil{n/2}\rceil}_{a'} \ket{\lceil{n/2}\rceil }.
\end{align*}

How sharp is the distribution for $n = 10$, and $n = 100$, or as a function of $n$, if a general solution exists? To answer this, we look at the probability of the number states for a given $n$. The probability of measuring a tensor product of number states $\ket{n-k}_{a'}\ket{k}_{b'}$ is simply $C^{n}_k/2^{n}$, which is nothing but $\text{B}(n,p=1/2)$, the binomial distribution with parameters $n$ and $p=1/2$. From here, we know from statistics that the standard deviation of the distribution, for a given $n$, is just $\sigma = \sqrt{np(1-p)} = \sqrt{n}/2$.  For $n=10$, we have $\sigma = \sqrt{5} \approx 2.24$. For $n=100$, we have $\sigma = 10/\sqrt{2} \approx 7.07$. 

\end{enumerate}


\noindent \textbf{4. The Hanbury-Brown and Twiss experiment and $g^{(2)}(\tau)$.} \\

\noindent Here we look at how the HBT experiment measures $g^{(2)}(\tau)$. To this end, let $a,a^\dagger,b,b^\dagger$ be the raising and lowering operators for the two modes of light input to the beamsplitter, and let the unitary transformation performed by the beamsplitter be defined by 
\begin{align*}
a_1 = U a U^\dagger = \f{a+b}{\sqrt{2}} \quad\quad b_1 = UbU^\dagger = \f{a-b}{\sqrt{2}}.
\end{align*}
For light input in state $\ket{\psi_a}$, suppose that the output of the coincidence circuit is a voltage
\begin{align*}
V_{\psi_a,0_b} = V_0 \bra{\psi_a,  0_b} a_1^\dagger a_1 b_1^\dagger b_1 \ket{\psi_a, 0_b},
\end{align*}
which is nothing but the average of the product of the two detected photon signals. We will show that $V_{\psi_a,0_b}$ gives measure of $g^{(2)}(\tau)$ up to an additive offset and normalization. To this end, we ignore all multiplicative factors and just compute the "meat:"
\begin{align*}
\bra{\psi_a, 0_b} a_1^\dagger a_1 b_1^\dagger b_1 \ket{\psi_a, 0_b} 
&\propto \bra{\psi_a, 0_b}  (a^\dagger + b^\dagger)( a + b)( a^\dagger - b^\dagger)( a- b)   \ket{\psi_a, 0_b}.
\end{align*}
Now, notice that terms with $b$ as the right-most operator and terms with $b^\dagger$ as the left-most operator vanish (right and left in the $b$ mode, of course), since $b\ket{0}_b = 0 = \bra{0}b^\dagger$. This leaves us with
\begin{align*}
\bra{\psi_a, 0_b} a_1^\dagger a_1 b_1^\dagger b_1 \ket{\psi_a, 0_b}  
&\propto \bra{\psi_a, 0_b}  a^\dagger(a+b)(a^\dagger - b^\dagger) a \ket{\psi_a, 0_b}  \\
&= \bra{\psi_a, 0_b}  a^\dagger(a+b)(a^\dagger - b^\dagger) a \ket{\psi_a, 0_b}  \\
&= \bra{\psi_a, 0_b}  a^\dagger a a^\dagger a -a^\dagger a^\dagger bb^\dagger \ket{\psi_a, 0_b} \\
&= \bra{\psi_a, 0_b} a^\dagger a^\dagger a  a  + a^\dagger a - a^\dagger a^\dagger (1+b^\dagger b) \ket{\psi_a, 0_b} \\
&=  \bra{\psi_a, 0_b} a^\dagger a^\dagger a a \ket{\psi_a, 0_b} + 
 \bra{\psi_a, 0_b} a^\dagger (a - a^\dagger)  \ket{\psi_a, 0_b}\\
 &= \bra{\psi_a, 0_b} a^\dagger a^\dagger a a \ket{\psi_a, 0_b} + \text{offset}
\end{align*}
We recognize that $V_{\psi_a, 0_b}$ gives $g^{(2)}(\tau)$ up to an additive offset and a normalization constant, as desired. 




\end{document}








