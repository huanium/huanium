(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31516,        988]
NotebookOptionsPosition[     28334,        923]
NotebookOutlinePosition[     28750,        939]
CellTagsIndexPosition[     28707,        936]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"M", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"w", "*", "t"}], "]"}], ",", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"w", "*", "t"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"w", "*", "t"}], "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"w", "*", "t"}], "]"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.885894541188616*^9, 3.88589456392065*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"1cef49e4-65e0-484f-9fc1-d7005f04ab9d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"t", " ", "w"}], "]"}], ",", 
     RowBox[{"Sin", "[", 
      RowBox[{"t", " ", "w"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{"t", " ", "w"}], "]"}]}], ",", 
     RowBox[{"Cos", "[", 
      RowBox[{"t", " ", "w"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8858945644983625`*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"9b949cd6-25e4-47a1-9190-d2d5cfb407a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", "M", "]"}], "//", "FullSimplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8858945661865573`*^9, 3.885894598715042*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"59f6bef3-f792-4a48-a9e3-3f0f0240fdd1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       RowBox[{"t", " ", "w"}], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"t", " ", "w"}], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       RowBox[{"t", " ", "w"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"t", " ", "w"}], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.885894573690491*^9, 3.885894598909719*^9}},
 CellLabel->
  "Out[4]//MatrixForm=",ExpressionUUID->"02b47561-7577-4c01-9f29-\
aa4a5176a7df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", "M", "]"}], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xR", "[", "t", "]"}], ",", 
     RowBox[{"yR", "[", "t", "]"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8858980238998337`*^9, 3.8858980249577265`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"28034f53-a899-40ec-ba1f-e489d58025dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"t", " ", "w"}], "]"}], " ", 
     RowBox[{"xR", "[", "t", "]"}]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"t", " ", "w"}], "]"}], " ", 
     RowBox[{"yR", "[", "t", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"t", " ", "w"}], "]"}], " ", 
     RowBox[{"xR", "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"t", " ", "w"}], "]"}], " ", 
     RowBox[{"yR", "[", "t", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8858980221633*^9, 3.8858980251638746`*^9}},
 CellLabel->"Out[33]=",ExpressionUUID->"43f4c8c2-92de-4585-a0b8-6d4f4dd5a028"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", "M", "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xR", "[", "t", "]"}], ",", 
       RowBox[{"yR", "[", "t", "]"}]}], "}"}]}], ",", "t"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8858947332651463`*^9, 3.8858947700727606`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"dc601431-3c0d-4a08-ad43-a5658fac74fe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"t", " ", "w"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "w"}], " ", 
        RowBox[{"yR", "[", "t", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["xR", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"t", " ", "w"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w", " ", 
        RowBox[{"xR", "[", "t", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["yR", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"t", " ", "w"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "w"}], " ", 
        RowBox[{"yR", "[", "t", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["xR", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"t", " ", "w"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w", " ", 
        RowBox[{"xR", "[", "t", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["yR", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.885894755759837*^9, 3.8858947705460215`*^9}},
 CellLabel->"Out[7]=",ExpressionUUID->"0b8f7630-4755-4781-8384-cae9092c2a53"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"t", " ", "w"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "w"}], " ", 
           RowBox[{"yR", "[", "t", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["xR", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "w"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"w", " ", 
           RowBox[{"xR", "[", "t", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["yR", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}], 
     "^", "2"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"t", " ", "w"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "w"}], " ", 
           RowBox[{"yR", "[", "t", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["xR", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"t", " ", "w"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"w", " ", 
           RowBox[{"xR", "[", "t", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["yR", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}], 
     "^", "2"}]}], "//", "FullSimplify"}], "//", "Expand"}]], "Input",
 CellChangeTimes->{{3.8858951156583805`*^9, 3.8858951363371115`*^9}, {
  3.885895204267575*^9, 3.88589523019722*^9}, {3.88589542248394*^9, 
  3.8858954291074915`*^9}, {3.885895490547784*^9, 3.885895492710787*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"39149489-c75f-4cb6-b671-4d32e29ce246"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["w", "2"], " ", 
   SuperscriptBox[
    RowBox[{"xR", "[", "t", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox["w", "2"], " ", 
   SuperscriptBox[
    RowBox[{"yR", "[", "t", "]"}], "2"]}], "-", 
  RowBox[{"2", " ", "w", " ", 
   RowBox[{"yR", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["xR", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  SuperscriptBox[
   RowBox[{
    SuperscriptBox["xR", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
  RowBox[{"2", " ", "w", " ", 
   RowBox[{"xR", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["yR", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  SuperscriptBox[
   RowBox[{
    SuperscriptBox["yR", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], "2"]}]], "Output",
 CellChangeTimes->{{3.8858951181276693`*^9, 3.88589513708156*^9}, {
   3.8858952073573084`*^9, 3.8858952304142303`*^9}, 3.8858954312493925`*^9, 
   3.885895492915741*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"e34ed9c5-892a-47a4-93b8-465e9c3fae75"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Lag", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w", "*", 
        RowBox[{"xR", "[", "t", "]"}]}], " ", "+", 
       RowBox[{
        RowBox[{"yR", "'"}], "[", "t", "]"}]}], ")"}], "^", "2"}], " ", "+", 
    " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w", "*", 
        RowBox[{"yR", "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"xR", "'"}], "[", "t", "]"}]}], ")"}], "^", "2"}]}], "//", 
   "Expand"}]}]], "Input",
 CellChangeTimes->{{3.8858957232712708`*^9, 3.8858957572947006`*^9}, {
  3.8858959769340534`*^9, 3.8858959772442093`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"d59b9ae6-2a1c-47b8-88d8-423ab9458693"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["w", "2"], " ", 
   SuperscriptBox[
    RowBox[{"xR", "[", "t", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox["w", "2"], " ", 
   SuperscriptBox[
    RowBox[{"yR", "[", "t", "]"}], "2"]}], "-", 
  RowBox[{"2", " ", "w", " ", 
   RowBox[{"yR", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["xR", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  SuperscriptBox[
   RowBox[{
    SuperscriptBox["xR", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
  RowBox[{"2", " ", "w", " ", 
   RowBox[{"xR", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["yR", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  SuperscriptBox[
   RowBox[{
    SuperscriptBox["yR", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], "2"]}]], "Output",
 CellChangeTimes->{{3.885895753138649*^9, 3.8858957574826317`*^9}, 
   3.885895977508546*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"dce2cbc5-162c-4671-812c-93c8b07f9bb7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"t", " ", "w"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "w"}], " ", 
        RowBox[{"yR", "[", "t", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["xR", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"t", " ", "w"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w", " ", 
        RowBox[{"xR", "[", "t", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["yR", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}], "^", 
  "2"}]], "Input",
 CellChangeTimes->{{3.885895820692518*^9, 3.8858958345965567`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"55ec9fd8-f722-4990-a125-9ad28003fb0a"],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"t", " ", "w"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "w"}], " ", 
        RowBox[{"yR", "[", "t", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["xR", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"t", " ", "w"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w", " ", 
        RowBox[{"xR", "[", "t", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["yR", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}], 
  "2"]], "Output",
 CellChangeTimes->{{3.885895822632231*^9, 3.885895835260544*^9}},
 CellLabel->"Out[23]=",ExpressionUUID->"54222b76-05f4-4997-9f1d-6b7055f0262c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"Lag", ",", 
     RowBox[{
      RowBox[{"xR", "'"}], "[", "t", "]"}]}], "]"}], "*", 
   RowBox[{"(", 
    RowBox[{"m", "/", "2"}], ")"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8858959794306374`*^9, 3.885896011620719*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"f38d4d41-1a03-4eda-87bf-60792c8b899a"],

Cell[BoxData[
 RowBox[{"m", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "w"}], " ", 
     RowBox[{"yR", "[", "t", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["xR", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8858959848959055`*^9, 3.8858960119743266`*^9}},
 CellLabel->"Out[29]=",ExpressionUUID->"6dfebd0f-408f-4402-880c-8ec71e8c2cca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"Lag", ",", 
     RowBox[{
      RowBox[{"yR", "'"}], "[", "t", "]"}]}], "]"}], "*", 
   RowBox[{"(", 
    RowBox[{"m", "/", "2"}], ")"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.885896065277333*^9, 3.8858960653492527`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"80d9b98e-8bc5-459d-8d6c-f945693baea8"],

Cell[BoxData[
 RowBox[{"m", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"w", " ", 
     RowBox[{"xR", "[", "t", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["yR", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.8858960655927844`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"b53318ed-5acb-4b8a-9c02-1f1417a7d1ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xR", "'"}], "[", "t", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"w", "*", "t"}], "]"}], "*", 
        RowBox[{"x", "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"w", "*", "t"}], "]"}], "*", 
        RowBox[{"y", "[", "t", "]"}]}]}], ",", "t"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], "->", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{"xR", "[", "t", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{"yR", "[", "t", "]"}]}]}]}], ",", 
      RowBox[{
       RowBox[{"y", "[", "t", "]"}], "->", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{"xR", "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{"yR", "[", "t", "]"}]}]}]}]}], "}"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.885897975292347*^9, 3.8858981281552773`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"d647f40e-851c-4315-8fc2-957ae5e52fac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", " ", 
   RowBox[{"yR", "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"t", " ", "w"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["x", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"t", " ", "w"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["y", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.885898000378249*^9, 3.8858980458526106`*^9, {3.885898097368535*^9, 
   3.8858981286976376`*^9}},
 CellLabel->"Out[39]=",ExpressionUUID->"8581a12e-470b-4364-8a97-5878fcb5f7ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"w", " ", 
    RowBox[{"yR", "[", "t", "]"}]}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"t", " ", "w"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["x", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "+", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"t", " ", "w"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["y", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"x", "'"}], "[", "t", "]"}], "->", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"t", " ", "w"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "w"}], " ", 
          RowBox[{"yR", "[", "t", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["xR", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"t", " ", "w"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"w", " ", 
          RowBox[{"xR", "[", "t", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["yR", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"y", "'"}], "[", "t", "]"}], "->", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"t", " ", "w"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "w"}], " ", 
          RowBox[{"yR", "[", "t", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["xR", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"t", " ", "w"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"w", " ", 
          RowBox[{"xR", "[", "t", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["yR", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.8858981318210993`*^9, 3.8858981403902135`*^9}, {
  3.885898193699793*^9, 3.8858982030192056`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"5a1931bd-75b8-43f2-8d47-a547b3aa5685"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", " ", 
   RowBox[{"yR", "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"t", " ", "w"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"t", " ", "w"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"t", " ", "w"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", " ", 
         RowBox[{"xR", "[", "t", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["yR", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
  "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"t", " ", "w"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"t", " ", "w"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"t", " ", "w"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", " ", 
         RowBox[{"xR", "[", "t", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["yR", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.885898136398641*^9, 3.885898140635271*^9}, {
  3.8858981944528036`*^9, 3.885898203380829*^9}},
 CellLabel->"Out[44]=",ExpressionUUID->"b2a9a5ee-270a-4303-89f5-cf7e82214c28"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"w", " ", 
   RowBox[{"yR", "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"t", " ", "w"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"t", " ", "w"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"t", " ", "w"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", " ", 
         RowBox[{"xR", "[", "t", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["yR", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
  "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"t", " ", "w"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"t", " ", "w"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"t", " ", "w"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", " ", 
         RowBox[{"xR", "[", "t", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["yR", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.885898208132593*^9, 3.8858982405469265`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"f7f95455-56f7-4071-91d0-7009f783d356"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", " ", 
   RowBox[{"yR", "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"t", " ", "w"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"t", " ", "w"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"t", " ", "w"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", " ", 
         RowBox[{"xR", "[", "t", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["yR", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
  "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"t", " ", "w"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"t", " ", "w"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "w"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"t", " ", "w"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", " ", 
         RowBox[{"xR", "[", "t", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["yR", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8858982255775747`*^9, 3.8858982410810347`*^9}},
 CellLabel->"Out[46]=",ExpressionUUID->"4ca2fd1f-8569-40a7-8244-3efdb363ab2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ham", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pRx", "[", "t", "]"}], "+", 
         RowBox[{"m", "*", "w", "*", 
          RowBox[{"yR", "[", "t", "]"}]}]}], ")"}], "/", "m"}], ")"}], "*", 
     RowBox[{"pRx", "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pRy", "[", "t", "]"}], "-", 
         RowBox[{"m", "*", "w", "*", 
          RowBox[{"xR", "[", "t", "]"}]}]}], ")"}], "/", "m"}], ")"}], "*", 
     RowBox[{"pRy", "[", "t", "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"m", "/", "2"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pRx", "[", "t", "]"}], "+", 
             RowBox[{"m", "*", "w", "*", 
              RowBox[{"yR", "[", "t", "]"}]}]}], ")"}], "/", "m"}], "-", 
          RowBox[{"w", "*", 
           RowBox[{"yR", "[", "t", "]"}]}]}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pRy", "[", "t", "]"}], "-", 
             RowBox[{"m", "*", "w", "*", 
              RowBox[{"xR", "[", "t", "]"}]}]}], ")"}], "/", "m"}], "+", 
          RowBox[{"w", "*", 
           RowBox[{"xR", "[", "t", "]"}]}]}], ")"}], "^", "2"}]}], ")"}]}]}], 
   "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.8859003378357306`*^9, 3.885900493182584*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"863fdca0-672c-4c2c-8451-4ff263f79e1b"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"pRx", "[", "t", "]"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"pRy", "[", "t", "]"}], "2"], "-", 
   RowBox[{"2", " ", "m", " ", "w", " ", 
    RowBox[{"pRy", "[", "t", "]"}], " ", 
    RowBox[{"xR", "[", "t", "]"}]}], "+", 
   RowBox[{"2", " ", "m", " ", "w", " ", 
    RowBox[{"pRx", "[", "t", "]"}], " ", 
    RowBox[{"yR", "[", "t", "]"}]}]}], 
  RowBox[{"2", " ", "m"}]]], "Output",
 CellChangeTimes->{3.8859004940572057`*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"c568cdbb-a72f-4fc2-a822-93c046d7b119"]
}, Open  ]]
},
WindowSize->{569.25, 624.75},
WindowMargins->{{-1221.75, Automatic}, {36.75, Automatic}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8c03feab-2a26-48ad-ab9e-f3a2938e1985"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 633, 18, 28, "Input",ExpressionUUID->"1cef49e4-65e0-484f-9fc1-d7005f04ab9d"],
Cell[1216, 42, 556, 17, 32, "Output",ExpressionUUID->"9b949cd6-25e4-47a1-9190-d2d5cfb407a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1809, 64, 278, 6, 28, "Input",ExpressionUUID->"59f6bef3-f792-4a48-a9e3-3f0f0240fdd1"],
Cell[2090, 72, 915, 28, 60, "Output",ExpressionUUID->"02b47561-7577-4c01-9f29-aa4a5176a7df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3042, 105, 384, 10, 28, "Input",ExpressionUUID->"28034f53-a899-40ec-ba1f-e489d58025dc"],
Cell[3429, 117, 734, 22, 32, "Output",ExpressionUUID->"43f4c8c2-92de-4585-a0b8-6d4f4dd5a028"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4200, 144, 447, 12, 28, "Input",ExpressionUUID->"dc601431-3c0d-4a08-ad43-a5658fac74fe"],
Cell[4650, 158, 1542, 49, 52, "Output",ExpressionUUID->"0b8f7630-4755-4781-8384-cae9092c2a53"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6229, 212, 1973, 57, 67, "Input",ExpressionUUID->"39149489-c75f-4cb6-b671-4d32e29ce246"],
Cell[8205, 271, 1114, 31, 52, "Output",ExpressionUUID->"e34ed9c5-892a-47a4-93b8-465e9c3fae75"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9356, 307, 728, 22, 28, "Input",ExpressionUUID->"d59b9ae6-2a1c-47b8-88d8-423ab9458693"],
Cell[10087, 331, 1037, 30, 52, "Output",ExpressionUUID->"dce2cbc5-162c-4671-812c-93c8b07f9bb7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11161, 366, 882, 27, 28, "Input",ExpressionUUID->"55ec9fd8-f722-4990-a125-9ad28003fb0a"],
Cell[12046, 395, 882, 27, 32, "Output",ExpressionUUID->"54222b76-05f4-4997-9f1d-6b7055f0262c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12965, 427, 390, 10, 28, "Input",ExpressionUUID->"f38d4d41-1a03-4eda-87bf-60792c8b899a"],
Cell[13358, 439, 420, 11, 32, "Output",ExpressionUUID->"6dfebd0f-408f-4402-880c-8ec71e8c2cca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13815, 455, 390, 10, 28, "Input",ExpressionUUID->"80d9b98e-8bc5-459d-8d6c-f945693baea8"],
Cell[14208, 467, 373, 10, 32, "Output",ExpressionUUID->"b53318ed-5acb-4b8a-9c02-1f1417a7d1ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14618, 482, 1408, 43, 86, "Input",ExpressionUUID->"d647f40e-851c-4315-8fc2-957ae5e52fac"],
Cell[16029, 527, 655, 19, 32, "Output",ExpressionUUID->"8581a12e-470b-4364-8a97-5878fcb5f7ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16721, 551, 2337, 73, 86, "Input",ExpressionUUID->"5a1931bd-75b8-43f2-8d47-a547b3aa5685"],
Cell[19061, 626, 2319, 72, 90, "Output",ExpressionUUID->"b2a9a5ee-270a-4303-89f5-cf7e82214c28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21417, 703, 2269, 71, 143, "Input",ExpressionUUID->"f7f95455-56f7-4071-91d0-7009f783d356"],
Cell[23689, 776, 2272, 71, 90, "Output",ExpressionUUID->"4ca2fd1f-8569-40a7-8244-3efdb363ab2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25998, 852, 1732, 51, 105, "Input",ExpressionUUID->"863fdca0-672c-4c2c-8451-4ff263f79e1b"],
Cell[27733, 905, 585, 15, 50, "Output",ExpressionUUID->"c568cdbb-a72f-4fc2-a822-93c046d7b119"]
}, Open  ]]
}
]
*)

