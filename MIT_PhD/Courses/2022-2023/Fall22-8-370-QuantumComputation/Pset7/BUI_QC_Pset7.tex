\documentclass{article}
\usepackage{physics}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{framed}
\usepackage{authblk}
\usepackage{empheq}
\usepackage{amsfonts}
\usepackage{esint}
\usepackage[makeroom]{cancel}
\usepackage{dsfont}
\usepackage{centernot}
\usepackage{mathtools}
\usepackage{subcaption}
\usepackage{bigints}
\usepackage{amsthm}
\theoremstyle{definition}
\newtheorem{lemma}{Lemma}
\newtheorem{defn}{Definition}[section]
\newtheorem{prop}{Proposition}[section]
\newtheorem{rmk}{Remark}[section]
\newtheorem{thm}{Theorem}[section]
\newtheorem{exmp}{Example}[section]
\newtheorem{prob}{Problem}[section]
\newtheorem{sln}{Solution}[section]
\newtheorem*{prob*}{Problem}
\newtheorem{exer}{Exercise}[section]
\newtheorem*{exer*}{Exercise}
\newtheorem*{sln*}{Solution}
\usepackage{empheq}
\usepackage{tensor}
\usepackage{xcolor}
%\definecolor{colby}{rgb}{0.0, 0.0, 0.5}
\definecolor{MIT}{RGB}{163, 31, 52}
\usepackage[pdftex]{hyperref}
%\hypersetup{colorlinks,urlcolor=colby}
\hypersetup{colorlinks,linkcolor={MIT},citecolor={MIT},urlcolor={MIT}}  
\usepackage[left=1in,right=1in,top=1in,bottom=1in]{geometry}

\usepackage{newpxtext,newpxmath}
\newcommand*\widefbox[1]{\fbox{\hspace{2em}#1\hspace{2em}}}

\newcommand{\p}{\partial}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\lag}{\mathcal{L}}
\newcommand{\nn}{\nonumber}
\newcommand{\ham}{\mathcal{H}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\I}{\mathcal{I}}
\newcommand{\K}{\mathcal{K}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\w}{\omega}
\newcommand{\lam}{\lambda}
\newcommand{\al}{\alpha}
\newcommand{\be}{\beta}
\newcommand{\x}{\xi}

\newcommand{\G}{\mathcal{G}}

\newcommand{\f}[2]{\frac{#1}{#2}}

\newcommand{\ift}{\infty}

\newcommand{\lp}{\left(}
\newcommand{\rp}{\right)}

\newcommand{\lb}{\left[}
\newcommand{\rb}{\right]}

\newcommand{\lc}{\left\{}
\newcommand{\rc}{\right\}}


\newcommand{\V}{\mathbf{V}}
\newcommand{\U}{\mathcal{U}}
\newcommand{\Id}{\mathcal{I}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\Z}{\mathcal{Z}}

%\setcounter{chapter}{-1}


\usepackage{enumitem}



\usepackage{listings}
\captionsetup[lstlisting]{margin=0cm,format=hang,font=small,format=plain,labelfont={bf,up},textfont={it}}
\renewcommand*{\lstlistingname}{Code \textcolor{violet}{\textsl{Mathematica}}}
\definecolor{gris245}{RGB}{245,245,245}
\definecolor{olive}{RGB}{50,140,50}
\definecolor{brun}{RGB}{175,100,80}

%\hypersetup{colorlinks,urlcolor=colby}
\lstset{
	tabsize=4,
	frame=single,
	language=mathematica,
	basicstyle=\scriptsize\ttfamily,
	keywordstyle=\color{black},
	backgroundcolor=\color{gris245},
	commentstyle=\color{gray},
	showstringspaces=false,
	emph={
		r1,
		r2,
		epsilon,epsilon_,
		Newton,Newton_
	},emphstyle={\color{olive}},
	emph={[2]
		L,
		CouleurCourbe,
		PotentielEffectif,
		IdCourbe,
		Courbe
	},emphstyle={[2]\color{blue}},
	emph={[3]r,r_,n,n_},emphstyle={[3]\color{magenta}}
}






\begin{document}
\begin{framed}
\noindent Name: \textbf{Huan Q. Bui}\\
Course: \textbf{8.370 - QC}\\
Problem set: \textbf{\#7}\\
Due: Wednesday, Nov 9, 2022\\
Collaborators/References: 
\end{framed}


\noindent \textbf{1. Factoring 21.} Suppose we use a unitary transformation which acts as
\begin{align*}
U \ket{u \mod 21} = \ket{2y \mod 21}
\end{align*}
on binary representation of numbers between 0 and 20. For the factoring algorithm we start with the state $\ket{1 \mod 21}$ and use phase estimation on the unitary $U$. If we have an eigenvector with eigenvalue $e^{2\pi i a/b}$. we will assume that phase estimation combined with continued fraction returns $a/b$ in reduced fraction form with probability 1.  

\begin{enumerate}[label=(\alph*)]

\item The state $\ket{1 \mod 21}$ can be represented as a superposition of the  eigenvectors of $U$. To find what these are, we first have to find the smallest $r > 0$ for which $2^r \equiv 1 \mod 21$. 

\begin{center}
\begin{tabular}{ c | c  c  c c  c c c c c} 
 $a^r$  & $2^0$ & $2^1$ & $2^2$ & $2^3$ & $2^4$ & $2^5$  & $2^6$ & $2^7$ & $2^8$ \\ 
 $a^r \mod 21$  & $1$ & $2$ & $4$ & $8$ & $16$ & $11$  & $1$ & $2$ & $4$ \\ 
\end{tabular}
\end{center}

So $r = 6$. We conclude that there are $\boxed{6}$ eigenvectors of $U$. They are of the form
\begin{align*}
\ket{\zeta_k} &= \f{1}{\sqrt{6}} \lp \ket{2^0 \mod 21} + e^{2\pi i k/6} \ket{2^1 \mod 21}  +  e^{4\pi i k/6}\ket{2^2 \mod 21} \right. \\
&\left. \quad + e^{6\pi i /6} \ket{2^3 \mod 21} +  e^{8 \pi i k/6 }\ket{2^4 \mod 21} + e^{10 \pi i k/6} \ket{2^5\mod 21} \rp, \quad k \in \{ 0,1,\dots, r-1\}
\end{align*}  
The state $\ket{1\mod 21}$ is then a  superposition of these states $\{ \zeta_k \}_{k=0}^{r-1} $:
\begin{align*}
\ket{1\mod 21} =  \f{1}{\sqrt{6}} \sum_{k=0}^{r-1}  \ket{\zeta_{k}}.
\end{align*}


\item Suppose the algorithm returns $k'/r'$ (which is in reduced form) and if $r'$ is even, we compute $2^{r'/2}$ and try to use it to factor. What is the probability that we get the right factors this way? To do this, we first list what we have donee right so far:
\begin{itemize}
\item $g=2$ is relatively prime to $21$, so it generates the cyclic group of order 21. The order of $g=2$ is $r=6$.

\item $g=2$ is also a good choice because $g^{r/2} - 1 = 2^{6/2}-1 = 7 \neq 21$ and $g^{r/2} + 1 = 2^{6/2}+1 = 9 \neq 21$. 
\end{itemize}
This means that the algorithm fails when $k'/r'$ (in reduced form) cannot be used to find $r$. The possible values that we can get are
\begin{align*}
\f{k'}{r'} \in \lc \f{0}{6}, \f{1}{6}, \f{1}{3}, \f{1}{2}, \f{2}{3}, \f{5}{6} \rc.
\end{align*}
These values of $k'/r'$ occur with equal probabilities. Of them, we find $r' = 3$ which is odd $1/3$ of the time. When $r'=2$ (which occurs $1/6$ of the time), we also reject it. So, we get the right factors $\boxed{1/2}$ of the time this way.

\end{enumerate}

\newpage

\noindent \textbf{2. Factoring algorithm failing.} In the last problem, we saw that even if the phase estimation and continued fractions pieces of the algorithm work perfectly, and we choose a  $g\in [1,N-1]$ that is relatively prime to $N$, use the unitary
\begin{align*}
U : \ket{ y \mod N}  \to \ket{gy \mod N}
\end{align*}
and get the correct period r, the factoring algorithm still has some probability of failing.

\begin{enumerate}[label=(\alph*)]

\item How bad is this problem for large $N$? To answer this question we first. 

\item Can you think of anything to do to make the factoring algorithm somewhat more efficient for large N? (Assume that quantum computation is expensive and classical computation is relatively cheap.)


\end{enumerate}



\newpage


\noindent \textbf{3. } For a prime $p$ and two numbers $a,b$ with $1 < a, b < p$, consider the quantum state
\begin{align*}
\f{1}{\sqrt{p}} \sum^{p-1}_{j=0} \ket{ j \mod p } \ket{(aj + b) \mod p}
\end{align*}

\begin{enumerate}[label=(\alph*)]

\item Show that if you are given one copy of this quantum state, then with a quantum computer, you can find $a$ with high probability (i.e., with probability going to $1$ as $p$ goes to $\infty$). 

\item Show that you can also find $b$ with high probability (i.e., with probability going to $1$ as $p$ goes to $\infty$).

\item Show that no quantum algorithm can identify $a$ with probability $1$.

\textbf{Hint:} there are two techniques that weâ€™ve seen in class that you might use to attack parts (a) and (b). One is the quantum Fourier transform and the other is phase estimation. One of these techniques works substantially better than the other.


\end{enumerate}



\end{document}











