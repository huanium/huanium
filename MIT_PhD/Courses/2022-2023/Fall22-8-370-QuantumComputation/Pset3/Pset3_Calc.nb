(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32633,        883]
NotebookOptionsPosition[     27652,        802]
NotebookOutlinePosition[     28062,        818]
CellTagsIndexPosition[     28019,        815]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]z", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]x", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"HadamardMatrix", "[", "2", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8737301898925104`*^9, 3.873730238148426*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"1407b74f-c536-475d-a8e1-8fdb902fa072"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"H", ".", "\[Sigma]z", ".", "H"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8737302211584606`*^9, 3.8737302298823814`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"6166f6ad-c542-4454-b6d4-9666ff9272e3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {"1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8737302249909344`*^9, 3.8737302393037043`*^9}},
 CellLabel->
  "Out[12]//MatrixForm=",ExpressionUUID->"381b9494-1b6a-458a-9e9a-\
c9df82e5ee35"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "I"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8737302477448435`*^9, 3.873730256320285*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"edeeff6b-a5cd-4e81-80c2-e81bdee8b3b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NN", "=", 
   RowBox[{"H", ".", "M", ".", "H"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8737302584995174`*^9, 3.8737302877153425`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"c161135c-b393-4932-b6a3-c92c32c70352"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NN", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8737303431741962`*^9, 3.87373034550109*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"4b803474-3706-4698-a7c5-08c7ad1cec9f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}]},
     {
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8737303456977386`*^9},
 CellLabel->
  "Out[21]//MatrixForm=",ExpressionUUID->"c3ff3e73-dbe6-453c-9a85-\
fd0a7583e331"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NN", ".", "NN"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8737302755242257`*^9, 3.873730281503755*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"095a160b-1965-41c5-8076-b32084e3122c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.873730276664542*^9, 3.873730289523799*^9}},
 CellLabel->"Out[20]=",ExpressionUUID->"3a66d6fe-95c1-4597-86ce-c5fdef8abe6e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"CNOT12", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.873730412262834*^9, 3.873730441866214*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"1a3d75b3-cd1c-4493-a9c4-4b6037127df0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CNOT21", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.873730450985474*^9, 3.87373046410309*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"a46b6dd9-2456-4ddf-a87d-19e18df01035"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SWAP12", "=", 
   RowBox[{"CNOT21", ".", "CNOT12", ".", "CNOT21"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8737304709157643`*^9, 3.8737304801156225`*^9}, {
  3.873731972158827*^9, 3.873731983327458*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"47d8a0fe-b93b-407e-9279-c9112b7f93f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Id", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8737319509784875`*^9, 3.8737319578680425`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"b944b850-dcf8-45b7-9581-ad8bfbfc14fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CH32", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "0", ",", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8737320621669054`*^9, 3.873732093635826*^9}, {
  3.873732133104288*^9, 3.8737322141430473`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"dc3473bc-c57e-483b-96cc-719fac218b5c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CH32", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8737323123714314`*^9, 3.873732315420717*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"6790c063-fbc6-4dd4-b2d4-0b8c310a3597"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      FractionBox["1", 
       SqrtBox["2"]]},
     {"0", "0", "1", "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8737323156100874`*^9},
 CellLabel->
  "Out[44]//MatrixForm=",ExpressionUUID->"86a8bd0a-65dd-4b93-821b-\
ff625d8a7133"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"SWAP12", ",", "Id"}], "]"}], ".", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"Id", ",", "CH32"}], "]"}], ".", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"SWAP12", ",", "Id"}], "]"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8737319592781734`*^9, 3.8737319889580526`*^9}, {
  3.8737320469072123`*^9, 3.8737320601658993`*^9}, {3.873732160443762*^9, 
  3.873732160944513*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"5db4a2a4-8b1a-4f9b-ade6-78ec0d27e6e7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]]},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.873731978878527*^9, 3.8737319891484504`*^9}, {
  3.873732161373739*^9, 3.873732215203338*^9}},
 CellLabel->
  "Out[43]//MatrixForm=",ExpressionUUID->"5f45e8cf-12a3-4460-86f5-\
be4ad8badc33"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Problem", " ", "5"}], "*)"}]], "Input",
 CellChangeTimes->{{3.873763637792126*^9, 3.873763641502962*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"a7441455-1a08-4810-9a6e-c21e8c35d11e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Id", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8738382495463037`*^9, 3.8738382558984785`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"cdf8f568-8ae6-4555-9266-cb1d2fa6a0b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"H3", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"Id", ",", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"Id", ",", 
       RowBox[{"HadamardMatrix", "[", "2", "]"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8737636430775456`*^9, 3.8737636463005266`*^9}, {
  3.8737641094311943`*^9, 3.873764123632987*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"108afbb3-1511-4bde-a61f-c03c9781ff54"],

Cell[BoxData[
 RowBox[{
  RowBox[{"T3", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"Id", ",", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"Id", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", "*", 
             RowBox[{"Pi", "/", "4"}]}], "]"}]}], "}"}]}], "}"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8737636486416163`*^9, 3.873763665982767*^9}, {
  3.873764032007589*^9, 3.8737640452511015`*^9}, {3.873764273825121*^9, 
  3.873764277873372*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"75fdebfa-58d3-46a6-9c0e-8ca17f04e9d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CNOT", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.873763668378849*^9, 3.8737637010158873`*^9}, {
  3.8737639687223787`*^9, 3.8737639688538704`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"dd68bfe5-47be-4b44-b575-bb40e3e0067b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CNOT12", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"CNOT", ",", "Id"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8737637026234818`*^9, 3.873763705470771*^9}, {
  3.8737639699124565`*^9, 3.8737639806908054`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"c27ce3cc-6dd2-4e94-970e-7072e9a14f0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CNOT23", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"Id", ",", "CNOT"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8737639819651766`*^9, 3.873763992820526*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"a5948e3d-3171-47a5-bf53-0902636785d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CNOT13", "=", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"SWAP12", ",", "Id"}], "]"}], ".", "CNOT23", ".", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"SWAP12", ",", "Id"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8737637077268915`*^9, 3.8737637812408447`*^9}, {
  3.873763996804468*^9, 3.873763997484779*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"b255b3ff-c03a-4f26-9636-3bd30548cede"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "\[Phi]"}], "]"}]}], "}"}]}], "}"}], ",", "Id"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873764764206868*^9, 3.873764877404623*^9}, {
  3.8737655940020924`*^9, 3.8737656004468293`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"a03aaf7c-4d20-4448-9998-a084d0b9a8db"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"circ", "=", 
  RowBox[{"H3", ".", "T3", ".", "CNOT13", ".", 
   RowBox[{"ConjugateTranspose", "[", "T3", "]"}], ".", "CNOT23", ".", "T3", 
   ".", "CNOT13", ".", 
   RowBox[{"ConjugateTranspose", "[", "T3", "]"}], ".", "CNOT23", ".", 
   "H3"}]}]], "Input",
 CellChangeTimes->{{3.8737639485379915`*^9, 3.873763963767606*^9}, {
  3.8737640086956635`*^9, 3.8737641305957403`*^9}, {3.873764413590595*^9, 
  3.8737644140232325`*^9}, {3.8737644758313394`*^9, 3.873764476480502*^9}, {
  3.873764542520895*^9, 3.8737645440452347`*^9}, {3.873764577894088*^9, 
  3.8737645784334188`*^9}, {3.8737646592556057`*^9, 3.873764659959101*^9}, {
  3.8737647003601165`*^9, 3.8737647469654875`*^9}, {3.873764798218573*^9, 
  3.8737647984825945`*^9}, {3.8737650355152946`*^9, 3.873765035693206*^9}, {
  3.8737651402601814`*^9, 3.8737651406310434`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"4a55b375-511f-4ccd-a1a8-5e3c7a55d87b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "\[ImaginaryI]"}], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8737641279317384`*^9, 3.873764130796283*^9}, 
   3.873764283495429*^9, 3.873764323027985*^9, 3.8737644143614473`*^9, 
   3.8737644774281616`*^9, 3.873764546194272*^9, 3.8737645815153613`*^9, 
   3.873764660576312*^9, {3.8737647014338675`*^9, 3.873764747266324*^9}, {
   3.8737647987994795`*^9, 3.8737648786249943`*^9}, 3.8737650360009694`*^9, 
   3.87376514098565*^9, 3.8738383229839067`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"6280f818-99be-4bf0-b9ee-44863e0004fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"circ", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8738383390926685`*^9, 3.8738383411248555`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"e9188211-8b86-4904-91d8-f088a69a520d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[ImaginaryI]"}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.873838341315493*^9},
 CellLabel->
  "Out[25]//MatrixForm=",ExpressionUUID->"408268a4-f82e-40d2-96dd-\
2dd45ff05ff3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", "\[Theta]_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Exp", "[", 
        RowBox[{"I", "*", "\[Theta]"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8737682169318914`*^9, 3.8737682359188557`*^9}, {
  3.873769380543197*^9, 3.873769380721587*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"52c84f64-65f4-403a-922c-6549598b15c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CNOT2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.873768549408949*^9, 3.8737685683645253`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"c6fc4e10-3b42-4cfc-9071-7dacb4eef777"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rz", "[", "a_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"I", "*", 
        RowBox[{"a", "/", "2"}]}], "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", 
        RowBox[{"a", "/", "2"}]}], "]"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.873769108707826*^9, 3.8737691350244513`*^9}, {
  3.8737691653831043`*^9, 3.8737691671364746`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"37e1df4e-83ad-4cdf-8193-0702703c724b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M1", "=", 
   RowBox[{"SWAP12", ".", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"Id", ",", 
      RowBox[{"P", "[", 
       RowBox[{"Pi", "/", "4"}], "]"}]}], "]"}], ".", "SWAP12"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8737684378092504`*^9, 3.873768483294832*^9}, {
  3.873768624161403*^9, 3.8737686269787245`*^9}, {3.873769178824718*^9, 
  3.8737692250723867`*^9}, {3.87376938445835*^9, 3.873769384542885*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"2af6643d-50be-445c-ac6c-51ff0b282b87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M2", "=", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"Id", ",", 
      RowBox[{"Rz", "[", 
       RowBox[{
        RowBox[{"-", "Pi"}], "/", "4"}], "]"}]}], "]"}], ".", "CNOT", ".", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"Id", ",", 
      RowBox[{"Rz", "[", 
       RowBox[{"Pi", "/", "4"}], "]"}]}], "]"}], ".", "CNOT"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.873766795344804*^9, 3.873766883084293*^9}, {
  3.8737671204820995`*^9, 3.8737671733430896`*^9}, {3.8737674710811787`*^9, 
  3.8737675846523657`*^9}, {3.873767626410333*^9, 3.8737676563120995`*^9}, {
  3.8737676950868187`*^9, 3.873767751095019*^9}, {3.8737679178037663`*^9, 
  3.8737679267039237`*^9}, {3.873767965882367*^9, 3.873767967888483*^9}, {
  3.873768130074815*^9, 3.8737681321005282`*^9}, {3.8737682394623804`*^9, 
  3.87376824768428*^9}, {3.8737682880660057`*^9, 3.873768288282715*^9}, {
  3.873768465790105*^9, 3.873768486190914*^9}, {3.8737686298380413`*^9, 
  3.873768649255059*^9}, {3.8737690560879335`*^9, 3.873769056435652*^9}, {
  3.87376909681155*^9, 3.87376910394094*^9}, {3.873769139194787*^9, 
  3.873769146348566*^9}, {3.8737692134193015`*^9, 3.8737692297955265`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"a4f4519e-7f87-4bf3-8fe6-6c932f66ce62"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M1", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8737684880684853`*^9, 3.8737684902776275`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"c804ef67-3441-4305-bf3e-ce08dccc3c56"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], "0"},
     {"0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.873768490477726*^9, 3.873768586263894*^9, {3.873768636162718*^9, 
   3.873768650344899*^9}, 3.8737690991681247`*^9, {3.8737691473359556`*^9, 
   3.873769230847329*^9}, 3.873838486955902*^9},
 CellLabel->
  "Out[32]//MatrixForm=",ExpressionUUID->"60deccbf-8efa-46c5-af2d-\
1bc0e547e5d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M2", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.873768491381854*^9, 3.8737684928634415`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"a5cc76ac-8c85-45b1-89ed-6c6298363c87"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], "0"},
     {"0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.87376849310204*^9, {3.873768639727158*^9, 3.873768651094597*^9}, 
   3.873769099840062*^9, {3.873769148038083*^9, 3.8737692315189447`*^9}, 
   3.8738384749142637`*^9},
 CellLabel->
  "Out[30]//MatrixForm=",ExpressionUUID->"e6001832-426a-4651-80fa-\
f8d7ea1a21ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"M1", ".", "M2"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8737684744592*^9, 3.8737685084219885`*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"e7f87233-e845-4f37-b0dc-ca2904384876"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "\[ImaginaryI]"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.873768476404936*^9, 3.873768508575669*^9}, {
   3.8737686434755697`*^9, 3.873768653157736*^9}, 3.8737691010072384`*^9, {
   3.873769149798624*^9, 3.873769232252755*^9}},
 CellLabel->
  "Out[286]//MatrixForm=",ExpressionUUID->"0206a8e3-8bfa-4d86-97d6-\
ca90cc077938"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Toff", "=", 
   RowBox[{"circ", ".", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"M1", ".", "M2"}], ",", "Id"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873838986654626*^9, 3.873839019086771*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"63190dea-837b-4f49-8579-933c286596f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Toff", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8738390200868597`*^9, 3.8738390224158*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"dd514731-e057-4ca4-b621-76b4d1a7218f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.873839022606705*^9},
 CellLabel->
  "Out[37]//MatrixForm=",ExpressionUUID->"739c2609-1435-47a1-935a-\
3e0409c56e9b"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.873766001973261*^9, 
  3.8737660034653797`*^9}},ExpressionUUID->"7a14ea5f-e8d8-4ce9-86c6-\
26d94aab759e"]
},
WindowSize->{513.75, 624.75},
WindowMargins->{{159, Automatic}, {34.5, Automatic}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ee3c2c9d-f9bd-4a4a-892a-cd4887bf07fc"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 487, 11, 67, "Input",ExpressionUUID->"1407b74f-c536-475d-a8e1-8fdb902fa072"],
Cell[CellGroupData[{
Cell[1070, 35, 249, 4, 28, "Input",ExpressionUUID->"6166f6ad-c542-4454-b6d4-9666ff9272e3"],
Cell[1322, 41, 648, 19, 60, "Output",ExpressionUUID->"381b9494-1b6a-458a-9e9a-c9df82e5ee35"]
}, Open  ]],
Cell[1985, 63, 369, 10, 28, "Input",ExpressionUUID->"edeeff6b-a5cd-4e81-80c2-e81bdee8b3b6"],
Cell[2357, 75, 251, 5, 28, "Input",ExpressionUUID->"c161135c-b393-4932-b6a3-c92c32c70352"],
Cell[CellGroupData[{
Cell[2633, 84, 206, 3, 28, "Input",ExpressionUUID->"4b803474-3706-4698-a7c5-08c7ad1cec9f"],
Cell[2842, 89, 986, 31, 76, "Output",ExpressionUUID->"c3ff3e73-dbe6-453c-9a85-fd0a7583e331"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3865, 125, 233, 4, 28, "Input",ExpressionUUID->"095a160b-1965-41c5-8076-b32084e3122c"],
Cell[4101, 131, 316, 8, 32, "Output",ExpressionUUID->"3a66d6fe-95c1-4597-86ce-c5fdef8abe6e"]
}, Open  ]],
Cell[4432, 142, 581, 15, 48, "Input",ExpressionUUID->"1a3d75b3-cd1c-4493-a9c4-4b6037127df0"],
Cell[5016, 159, 580, 15, 48, "Input",ExpressionUUID->"a46b6dd9-2456-4ddf-a87d-19e18df01035"],
Cell[5599, 176, 319, 6, 28, "Input",ExpressionUUID->"47d8a0fe-b93b-407e-9279-c9112b7f93f2"],
Cell[5921, 184, 259, 5, 28, "Input",ExpressionUUID->"b944b850-dcf8-45b7-9581-ad8bfbfc14fd"],
Cell[6183, 191, 913, 24, 48, "Input",ExpressionUUID->"dc3473bc-c57e-483b-96cc-719fac218b5c"],
Cell[CellGroupData[{
Cell[7121, 219, 209, 3, 28, "Input",ExpressionUUID->"6790c063-fbc6-4dd4-b2d4-0b8c310a3597"],
Cell[7333, 224, 888, 30, 114, "Output",ExpressionUUID->"86a8bd0a-65dd-4b93-821b-ff625d8a7133"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8258, 259, 566, 12, 48, "Input",ExpressionUUID->"5db4a2a4-8b1a-4f9b-ade6-78ec0d27e6e7"],
Cell[8827, 273, 1421, 44, 203, "Output",ExpressionUUID->"5f45e8cf-12a3-4460-86f5-be4ad8badc33"]
}, Open  ]],
Cell[10263, 320, 225, 4, 28, "Input",ExpressionUUID->"a7441455-1a08-4810-9a6e-c21e8c35d11e"],
Cell[10491, 326, 371, 10, 28, "Input",ExpressionUUID->"cdf8f568-8ae6-4555-9266-cb1d2fa6a0b2"],
Cell[10865, 338, 460, 11, 48, "Input",ExpressionUUID->"108afbb3-1511-4bde-a61f-c03c9781ff54"],
Cell[11328, 351, 749, 20, 48, "Input",ExpressionUUID->"75fdebfa-58d3-46a6-9c0e-8ca17f04e9d5"],
Cell[12080, 373, 633, 16, 48, "Input",ExpressionUUID->"dd68bfe5-47be-4b44-b575-bb40e3e0067b"],
Cell[12716, 391, 345, 7, 28, "Input",ExpressionUUID->"c27ce3cc-6dd2-4e94-970e-7072e9a14f0b"],
Cell[13064, 400, 292, 6, 28, "Input",ExpressionUUID->"a5948e3d-3171-47a5-bf53-0902636785d6"],
Cell[13359, 408, 463, 10, 48, "Input",ExpressionUUID->"b255b3ff-c03a-4f26-9636-3bd30548cede"],
Cell[13825, 420, 794, 20, 67, "Input",ExpressionUUID->"a03aaf7c-4d20-4448-9998-a084d0b9a8db"],
Cell[CellGroupData[{
Cell[14644, 444, 935, 15, 48, "Input",ExpressionUUID->"4a55b375-511f-4ccd-a1a8-5e3c7a55d87b"],
Cell[15582, 461, 1636, 40, 90, "Output",ExpressionUUID->"6280f818-99be-4bf0-b9ee-44863e0004fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17255, 506, 211, 3, 28, "Input",ExpressionUUID->"e9188211-8b86-4904-91d8-f088a69a520d"],
Cell[17469, 511, 1030, 27, 163, "Output",ExpressionUUID->"408268a4-f82e-40d2-96dd-2dd45ff05ff3"]
}, Open  ]],
Cell[18514, 541, 532, 15, 28, "Input",ExpressionUUID->"52c84f64-65f4-403a-922c-6549598b15c0"],
Cell[19049, 558, 582, 15, 48, "Input",ExpressionUUID->"c6fc4e10-3b42-4cfc-9071-7dacb4eef777"],
Cell[19634, 575, 635, 18, 28, "Input",ExpressionUUID->"37e1df4e-83ad-4cdf-8193-0702703c724b"],
Cell[20272, 595, 542, 12, 28, "Input",ExpressionUUID->"2af6643d-50be-445c-ac6c-51ff0b282b87"],
Cell[20817, 609, 1305, 25, 48, "Input",ExpressionUUID->"a4f4519e-7f87-4bf3-8fe6-6c932f66ce62"],
Cell[CellGroupData[{
Cell[22147, 638, 209, 3, 28, "Input",ExpressionUUID->"c804ef67-3441-4305-bf3e-ce08dccc3c56"],
Cell[22359, 643, 1093, 30, 114, "Output",ExpressionUUID->"60deccbf-8efa-46c5-af2d-1bc0e547e5d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23489, 678, 207, 3, 28, "Input",ExpressionUUID->"a5cc76ac-8c85-45b1-89ed-6c6298363c87"],
Cell[23699, 683, 1095, 31, 114, "Output",ExpressionUUID->"e6001832-426a-4651-80fa-f8d7ea1a21ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24831, 719, 233, 5, 28, "Input",ExpressionUUID->"e7f87233-e845-4f37-b0dc-ca2904384876"],
Cell[25067, 726, 857, 23, 94, "Output",ExpressionUUID->"0206a8e3-8bfa-4d86-97d6-ca90cc077938"]
}, Open  ]],
Cell[25939, 752, 343, 8, 28, "Input",ExpressionUUID->"63190dea-837b-4f49-8579-933c286596f3"],
Cell[CellGroupData[{
Cell[26307, 764, 207, 3, 28, "Input",ExpressionUUID->"dd514731-e057-4ca4-b621-76b4d1a7218f"],
Cell[26517, 769, 962, 25, 163, "Output",ExpressionUUID->"739c2609-1435-47a1-935a-3e0409c56e9b"]
}, Open  ]],
Cell[27494, 797, 154, 3, 28, "Input",ExpressionUUID->"7a14ea5f-e8d8-4ce9-86c6-26d94aab759e"]
}
]
*)

