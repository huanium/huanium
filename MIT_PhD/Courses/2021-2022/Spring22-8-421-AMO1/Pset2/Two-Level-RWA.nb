(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11718,        352]
NotebookOptionsPosition[     10056,        319]
NotebookOutlinePosition[     10447,        335]
CellTagsIndexPosition[     10404,        332]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"H1", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", "/", "2"}], ")"}], "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"wR", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"E", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "I"}], "*", "w", "*", "t"}], ")"}]}], "+", 
           RowBox[{"E", "^", 
            RowBox[{"(", 
             RowBox[{"I", "*", "w", "*", "t"}], ")"}]}]}], ")"}]}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wR", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"E", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"+", "I"}], "*", "w", "*", "t"}], ")"}]}], "+", 
           RowBox[{"E", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "I"}], "*", "w", "*", "t"}], ")"}]}]}], ")"}]}], 
        ",", "0"}], "}"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8541497317338753`*^9, 3.854149773317528*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"6258650b-988d-4b0a-a844-44ed40a35ba2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H1", "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.854152035539647*^9, 3.854152039670781*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"71f3a69a-55da-4bd1-9850-2513ed3eca5f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"h", " ", "wR", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"t", " ", "w"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"h", " ", "wR", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"t", " ", "w"}], "]"}]}], ",", "0"}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.854152036060444*^9, 3.854152039883486*^9}},
 CellLabel->"Out[37]=",ExpressionUUID->"55b1aef0-f5df-418c-b741-892d002012e7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"H0", "=", 
   RowBox[{"h", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"w1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "w2"}], "}"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.854149774541708*^9, 3.8541497909326773`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"f5f96ed9-fee4-457f-84b7-ed64111b8af0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"H1I", "=", 
   RowBox[{"TrigToExp", "[", 
    RowBox[{
     RowBox[{"MatrixExp", "[", 
      RowBox[{"I", "*", "H0", "*", 
       RowBox[{"t", "/", "h"}]}], "]"}], ".", "H1", ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], "*", "H0", "*", 
       RowBox[{"t", "/", "h"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8541497937817583`*^9, 3.854149889909109*^9}, 
   3.854151214347746*^9},
 CellLabel->"In[44]:=",ExpressionUUID->"7821eb0a-7884-49c3-8185-21e20eb9ec73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"H1RWA", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"h", "*", 
       RowBox[{"wR", "/", "2"}]}], ")"}], "*", 
     RowBox[{"TrigToExp", "[", 
      RowBox[{
       RowBox[{"MatrixExp", "[", 
        RowBox[{
         RowBox[{"-", "I"}], "*", "H0", "*", 
         RowBox[{"t", "/", "h"}]}], "]"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"E", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"+", "I"}], "*", "t", "*", 
              RowBox[{"(", 
               RowBox[{"w", "-", 
                RowBox[{"(", 
                 RowBox[{"w2", "-", "w1"}], ")"}]}], ")"}]}], ")"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"E", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "I"}], "*", "t", "*", 
              RowBox[{"(", 
               RowBox[{"w", "-", 
                RowBox[{"(", 
                 RowBox[{"w2", "-", "w1"}], ")"}]}], ")"}]}], ")"}]}], ",", 
           "0"}], "}"}]}], "}"}], ".", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{
         RowBox[{"+", "I"}], "*", "H0", "*", 
         RowBox[{"t", "/", "h"}]}], "]"}]}], "]"}]}], "//", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8541505889804277`*^9, 3.8541506454671707`*^9}, {
  3.854150830334799*^9, 3.854150832435361*^9}, {3.8541509066275663`*^9, 
  3.854150908363138*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"6a198836-52c6-4d01-8e19-e4d6ed3cd538"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HRWA", "=", 
   RowBox[{"H1RWA", "+", "H0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.854150647012354*^9, 3.854150656964588*^9}, 
   3.854151203807214*^9},
 CellLabel->"In[47]:=",ExpressionUUID->"7ac8d3db-c215-426f-90b0-7e213ed5eb2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{"I", "*", 
     RowBox[{"PauliMatrix", "[", "3", "]"}], "*", "w", "*", 
     RowBox[{"t", "/", "2"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.854150989963039*^9, 3.854151017442453*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"c2122e45-92a9-4fad-b40a-6dce6ff52e75"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HRWArot", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", "T", "]"}], ".", "HRWA", ".", "T"}], 
     "-", 
     RowBox[{"I", "*", "h", "*", 
      RowBox[{
       RowBox[{"ConjugateTranspose", "[", "T", "]"}], ".", 
       RowBox[{"D", "[", 
        RowBox[{"T", ",", "t"}], "]"}]}]}]}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"w", ">", "0"}], ",", 
       RowBox[{"t", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8541510215792513`*^9, 3.854151087218606*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"aa647c51-da8c-4111-8f6e-640ac04d7137"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "h", " ", 
      RowBox[{"(", 
       RowBox[{"w", "+", 
        RowBox[{"2", " ", "w1"}]}], ")"}]}], ",", 
     FractionBox[
      RowBox[{"h", " ", "wR"}], "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"h", " ", "wR"}], "2"], ",", 
     RowBox[{"h", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["w", "2"]}], "+", "w2"}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.85415105479676*^9, 3.854151087911954*^9}, 
   3.8541522273850937`*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"b20db479-d486-487e-b8d9-95bb5145b869"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"dubious", " ", "approach"}], "*)"}]], "Input",
 CellChangeTimes->{{3.854153964882806*^9, 3.854153971850025*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"b5ea9eb1-c7ea-432f-b0e3-1ee0137fa90a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"h", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"w1", ",", 
        RowBox[{"wR", "*", 
         RowBox[{"Cos", "[", 
          RowBox[{"w", "*", "t"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wR", "*", 
         RowBox[{"Cos", "[", 
          RowBox[{"w", "*", "t"}], "]"}]}], ",", "w2"}], "}"}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.854153973994432*^9, 3.854153995849777*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"10a0c474-457c-432e-bdd3-82aa928fc0c0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hrot", "=", 
  RowBox[{
   RowBox[{"TrigToExp", "[", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", "T", "]"}], ".", "H", ".", "T"}], 
       "-", 
       RowBox[{"I", "*", "h", "*", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", "T", "]"}], ".", 
         RowBox[{"D", "[", 
          RowBox[{"T", ",", "t"}], "]"}]}]}]}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"w", ">", "0"}], ",", 
         RowBox[{"t", ">", "0"}]}], "}"}]}]}], "]"}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.854154015633202*^9, 3.8541540431941223`*^9}, {
  3.85415407462642*^9, 3.854154087426557*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"b714001b-4ab3-4611-9305-1cf6c48c4982"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "h", " ", 
      RowBox[{"(", 
       RowBox[{"w", "+", 
        RowBox[{"2", " ", "w1"}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "t", " ", "w"}]]}], 
       ")"}], " ", "h", " ", "wR"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "t", " ", "w"}]]}], ")"}], 
      " ", "h", " ", "wR"}], ",", 
     RowBox[{"h", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["w", "2"]}], "+", "w2"}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.854154023865836*^9, 3.854154043419362*^9}, {
  3.8541540841611834`*^9, 3.854154087635337*^9}},
 CellLabel->"Out[10]=",ExpressionUUID->"4b3f9350-2b56-4330-a186-268fb58f9647"]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{-1065, Automatic}, {0, Automatic}},
FrontEndVersion->"12.3 for Linux x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"aba9973d-98b8-432c-9ef2-4c5ae20e2f1b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1175, 36, 30, "Input",ExpressionUUID->"6258650b-988d-4b0a-a844-44ed40a35ba2"],
Cell[CellGroupData[{
Cell[1758, 60, 207, 3, 30, "Input",ExpressionUUID->"71f3a69a-55da-4bd1-9850-2513ed3eca5f"],
Cell[1968, 65, 516, 15, 34, "Output",ExpressionUUID->"55b1aef0-f5df-418c-b741-892d002012e7"]
}, Open  ]],
Cell[2499, 83, 402, 11, 30, "Input",ExpressionUUID->"f5f96ed9-fee4-457f-84b7-ed64111b8af0"],
Cell[2904, 96, 548, 14, 30, "Input",ExpressionUUID->"7821eb0a-7884-49c3-8185-21e20eb9ec73"],
Cell[3455, 112, 1592, 46, 119, "Input",ExpressionUUID->"6a198836-52c6-4d01-8e19-e4d6ed3cd538"],
Cell[5050, 160, 270, 6, 30, "Input",ExpressionUUID->"7ac8d3db-c215-426f-90b0-7e213ed5eb2c"],
Cell[5323, 168, 360, 8, 30, "Input",ExpressionUUID->"c2122e45-92a9-4fad-b40a-6dce6ff52e75"],
Cell[CellGroupData[{
Cell[5708, 180, 709, 19, 53, "Input",ExpressionUUID->"aa647c51-da8c-4111-8f6e-640ac04d7137"],
Cell[6420, 201, 730, 24, 50, "Output",ExpressionUUID->"b20db479-d486-487e-b8d9-95bb5145b869"]
}, Open  ]],
Cell[7165, 228, 231, 4, 30, "Input",ExpressionUUID->"b5ea9eb1-c7ea-432f-b0e3-1ee0137fa90a"],
Cell[7399, 234, 597, 18, 30, "Input",ExpressionUUID->"10a0c474-457c-432e-bdd3-82aa928fc0c0"],
Cell[CellGroupData[{
Cell[8021, 256, 859, 23, 75, "Input",ExpressionUUID->"b714001b-4ab3-4611-9305-1cf6c48c4982"],
Cell[8883, 281, 1157, 35, 49, "Output",ExpressionUUID->"4b3f9350-2b56-4330-a186-268fb58f9647"]
}, Open  ]]
}
]
*)

