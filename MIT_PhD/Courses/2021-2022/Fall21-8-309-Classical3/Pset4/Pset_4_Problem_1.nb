(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32578,        940]
NotebookOptionsPosition[     29088,        873]
NotebookOutlinePosition[     29477,        889]
CellTagsIndexPosition[     29434,        886]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Problem", " ", "1"}], "*)"}]], "Input",
 CellChangeTimes->{{3.84290875936134*^9, 3.842908762575399*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"2d4e856d-25a0-4a75-984a-fdca7c204cb8"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Part", " ", 
   RowBox[{"(", "a", ")"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.842908764360675*^9, 3.842908768847327*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"7ab706d6-6f37-4284-98e0-1ae6be6f76a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EulerRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]1", "->", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}]}], ",", 
     RowBox[{"\[Omega]2", "->", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Omega]3", "->", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"\[Psi]", "'"}], "[", "t", "]"}]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.842908770448204*^9, 3.842908812447689*^9}, {
  3.842908886983672*^9, 3.8429089400955048`*^9}, {3.842909401263054*^9, 
  3.842909403454569*^9}, {3.842909487430867*^9, 3.842909489310351*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"bd90bb66-c68f-449e-95bb-2a89ddf91466"],

Cell[BoxData[
 RowBox[{"(*", "Lagrangian", "*)"}]], "Input",
 CellChangeTimes->{{3.8429093131508017`*^9, 3.84290931583002*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"fe9eff01-632d-42ae-af75-0d63f6bb50b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"I1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]1", "^", "2"}], "+", 
        RowBox[{"\[Omega]2", "^", "2"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"I3", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"\[Omega]3", "^", "2"}], ")"}]}], "-", 
     RowBox[{"m", "*", "g", "*", "R", "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], "/.", "EulerRules"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.842909311071344*^9, 3.8429094107421417`*^9}, {
  3.842909453622876*^9, 3.842909456230204*^9}, {3.842909511142481*^9, 
  3.8429095133100653`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"ede2956a-3fd1-428d-8e13-43f09abcf721"],

Cell[CellGroupData[{

Cell[BoxData["L"], "Input",
 CellChangeTimes->{
  3.842909390255143*^9, {3.8429095259342537`*^9, 3.842909526790489*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"e1cadba4-9b1b-4c18-9993-3a67c6964c31"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "g"}], " ", "m", " ", "R", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "I1", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], "2"]}], 
    ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "I3", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[Psi]", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], ")"}], 
    "2"]}]}]], "Output",
 CellChangeTimes->{{3.8429093906184397`*^9, 3.842909413002265*^9}, {
  3.8429094574169683`*^9, 3.8429095151607018`*^9}},
 CellLabel->"Out[5]=",ExpressionUUID->"a6b527e4-52e4-41be-a782-36af0a13d97b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], " ", 
        RowBox[{
         SuperscriptBox["\[Theta]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[Theta]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], "2"]}], ")"}],
   "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.842909547277714*^9, 3.842909548606658*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"6d27b69c-4a7e-4723-bf64-733ee6888b58"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["\[Phi]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.8429095488380613`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"71252833-97fc-4f79-ab7f-b7b5e6fdde15"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P\[Phi]", "=", 
  RowBox[{"D", "[", 
   RowBox[{"L", ",", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "t", "]"}], ",", "t"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.842909563366411*^9, 3.8429096333983707`*^9}, {
  3.842909769694216*^9, 3.8429097712692003`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"77f7545d-c14a-46c3-bc1d-d1f4e30179f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", "I1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], 
  "+", 
  RowBox[{"I3", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[Psi]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8429096082237587`*^9, 3.842909656051241*^9}, 
   3.84290977162099*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"0b2869d8-3c82-4d55-8ebf-29d6da71b551"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.842909803581148*^9, 3.842909807854065*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"ae01834e-684b-47ce-9ccd-93405e9ebfef"],

Cell[BoxData[
 RowBox[{"2", " ", 
  SuperscriptBox[
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "2"], " ", 
  RowBox[{
   SuperscriptBox["\[Phi]", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{3.8429104695006733`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"ff9732f3-d816-461d-8ae4-9de65a0ec586"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P\[Theta]", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"L", ",", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.842909644485653*^9, 3.842909652494862*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"a7259094-6b92-4f56-adf8-a0628f52f2c1"],

Cell[BoxData[
 RowBox[{"I1", " ", 
  RowBox[{
   SuperscriptBox["\[Theta]", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{{3.842909646992791*^9, 3.842909653079425*^9}},
 CellLabel->"Out[12]=",ExpressionUUID->"25f9b42f-5c90-4207-9a91-cd90094ae241"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P\[Psi]", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"L", ",", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Psi]", "[", "t", "]"}], ",", "t"}], "]"}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.842909657917974*^9, 3.842909667286983*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"0eb1d422-d682-46f0-a5a4-d599ccb6978c"],

Cell[BoxData[
 RowBox[{"I3", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Phi]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["\[Psi]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.8429096687141314`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"61156102-d01f-4cb4-8a05-02722ea38217"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmallAngles", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "->", 
      RowBox[{"\[Theta]", "[", "t", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], "->", 
      RowBox[{"2", "*", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "->", "1"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], "->", "1"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.842913911270945*^9, 3.842913967270488*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"8446243c-c928-4aed-89f3-83ce84b7e8a7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"E1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"I1", "*", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Omega]1", "/.", "EulerRules"}], ",", "t"}], "]"}]}], "+", 
      
      RowBox[{"\[Omega]2", "*", "\[Omega]3", "*", 
       RowBox[{"(", 
        RowBox[{"I3", "-", "I1"}], ")"}]}]}], "/.", "EulerRules"}], "/.", 
    "SmallAngles"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.842918668557506*^9, 3.8429187179502897`*^9}, {
  3.842919237076714*^9, 3.842919237660121*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"038f426e-d6c0-462b-b946-2db19e7b545a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "I1"}], "-", "I3"}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "-", 
     RowBox[{"I3", " ", 
      RowBox[{
       SuperscriptBox["\[Psi]", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "I1"}], "+", "I3"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"I3", " ", 
         RowBox[{
          SuperscriptBox["\[Psi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"I1", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"I1", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
   RowBox[{"\[Theta]", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.842918691481277*^9, 3.84291871901408*^9}, 
   3.842919237933199*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"b2ab4a7e-a97d-4eb8-abe1-1be71992ae67"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"E2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"I1", "*", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Omega]2", "/.", "EulerRules"}], ",", "t"}], "]"}]}], "+", 
      
      RowBox[{"\[Omega]1", "*", "\[Omega]3", "*", 
       RowBox[{"(", 
        RowBox[{"I1", "-", "I3"}], ")"}]}]}], "/.", "EulerRules"}], "/.", 
    "SmallAngles"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.842918819301169*^9, 3.8429188261158953`*^9}, {
  3.8429192391009483`*^9, 3.842919240547764*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"be0c6f9d-65cc-42df-88ee-e82f3369589c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "I1"}], "-", "I3"}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "-", 
     RowBox[{"I3", " ", 
      RowBox[{
       SuperscriptBox["\[Psi]", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"I1", "-", "I3"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "-", 
        RowBox[{"I3", " ", 
         RowBox[{
          SuperscriptBox["\[Psi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "-", 
     RowBox[{"I1", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"I1", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
   RowBox[{"\[Theta]", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{3.84291882722053*^9, 3.842919240975206*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"51c1f14a-767d-4be3-9cb4-bd469331a085"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"E11", "=", 
  RowBox[{"E1", "*", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.842919242028781*^9, 3.842919273187499*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"8a5c41de-7bd3-4535-af9b-fe2bd831d56f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cos", "[", 
   RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "I1"}], "-", "I3"}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "-", 
       RowBox[{"I3", " ", 
        RowBox[{
         SuperscriptBox["\[Psi]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "I1"}], "+", "I3"}], ")"}], " ", 
           RowBox[{
            SuperscriptBox["\[Phi]", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], "+", 
          RowBox[{"I3", " ", 
           RowBox[{
            SuperscriptBox["\[Psi]", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"I1", " ", 
        RowBox[{
         SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
    RowBox[{"I1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{"\[Theta]", "[", "t", "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.842919253917746*^9, 3.8429192738127203`*^9}},
 CellLabel->"Out[55]=",ExpressionUUID->"40cca88a-6442-450b-a77c-5dbe026f659e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"E22", "=", 
  RowBox[{"E2", "*", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.842919255548452*^9, 3.842919275811531*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"543b455f-cdb8-4556-94c2-d087e8313e7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sin", "[", 
   RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "I1"}], "-", "I3"}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "-", 
       RowBox[{"I3", " ", 
        RowBox[{
         SuperscriptBox["\[Psi]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"I1", "-", "I3"}], ")"}], " ", 
           RowBox[{
            SuperscriptBox["\[Phi]", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], "-", 
          RowBox[{"I3", " ", 
           RowBox[{
            SuperscriptBox["\[Psi]", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "-", 
       RowBox[{"I1", " ", 
        RowBox[{
         SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
    RowBox[{"I1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{"\[Theta]", "[", "t", "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.842919260262738*^9, 3.842919276805697*^9}},
 CellLabel->"Out[56]=",ExpressionUUID->"d8fc0f37-a7f0-464d-9372-a1287c44aa91"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"E11", "-", "E22"}], "==", 
      RowBox[{"m", "*", "g", "*", "R", "*", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], "]"}], "/.", 
    "SmallAngles"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.842919266004752*^9, 3.84291935510143*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"8b2f748b-9297-4111-b91d-af59b9ec03ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "I1"}], "+", "I3"}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{"I3", " ", 
       RowBox[{
        SuperscriptBox["\[Psi]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"I1", " ", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "\[Equal]", 
  RowBox[{"g", " ", "m", " ", "R", " ", 
   RowBox[{"\[Theta]", "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.842919280159932*^9, {3.8429193259669027`*^9, 3.842919355404579*^9}},
 CellLabel->"Out[61]=",ExpressionUUID->"1ccd0b8a-dffc-4cec-a8bf-d0c4b64b5243"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{"S", ",", 
    RowBox[{
     RowBox[{"\[Theta]", "''"}], "[", "t", "]"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8429194084208317`*^9, 3.842919421100819*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"f268f808-84c8-46d0-babf-b86c438b322a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Theta]", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "m", " ", "R"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"I1", "-", "I3"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["\[Phi]", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
        RowBox[{"I3", " ", 
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Psi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "I1"]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.8429194153866367`*^9, 3.842919421341217*^9}},
 CellLabel->"Out[63]=",ExpressionUUID->"5b0c53b4-36d1-42d3-afcd-6df336bea68b"]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{92, Automatic}, {31, Automatic}},
FrontEndVersion->"12.3 for Linux x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"24670daf-4f70-4a85-80d7-6aef7be07b04"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 223, 4, 30, "Input",ExpressionUUID->"2d4e856d-25a0-4a75-984a-fdca7c204cb8"],
Cell[784, 26, 245, 5, 30, "Input",ExpressionUUID->"7ab706d6-6f37-4284-98e0-1ae6be6f76a3"],
Cell[1032, 33, 1727, 47, 75, "Input",ExpressionUUID->"bd90bb66-c68f-449e-95bb-2a89ddf91466"],
Cell[2762, 82, 206, 3, 30, "Input",ExpressionUUID->"fe9eff01-632d-42ae-af75-0d63f6bb50b8"],
Cell[2971, 87, 871, 24, 30, "Input",ExpressionUUID->"ede2956a-3fd1-428d-8e13-43f09abcf721"],
Cell[CellGroupData[{
Cell[3867, 115, 198, 3, 30, "Input",ExpressionUUID->"e1cadba4-9b1b-4c18-9993-3a67c6964c31"],
Cell[4068, 120, 2217, 63, 86, "Output",ExpressionUUID->"a6b527e4-52e4-41be-a782-36af0a13d97b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6322, 188, 1483, 41, 56, "Input",ExpressionUUID->"6d27b69c-4a7e-4723-bf64-733ee6888b58"],
Cell[7808, 231, 538, 15, 34, "Output",ExpressionUUID->"71252833-97fc-4f79-ab7f-b7b5e6fdde15"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8383, 251, 402, 10, 30, "Input",ExpressionUUID->"77f7545d-c14a-46c3-bc1d-d1f4e30179f4"],
Cell[8788, 263, 2383, 66, 95, "Output",ExpressionUUID->"0b2869d8-3c82-4d55-8ebf-29d6da71b551"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11208, 334, 1739, 48, 53, "Input",ExpressionUUID->"ae01834e-684b-47ce-9ccd-93405e9ebfef"],
Cell[12950, 384, 369, 9, 34, "Output",ExpressionUUID->"ff9732f3-d816-461d-8ae4-9de65a0ec586"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13356, 398, 393, 10, 30, "Input",ExpressionUUID->"a7259094-6b92-4f56-adf8-a0628f52f2c1"],
Cell[13752, 410, 292, 6, 34, "Output",ExpressionUUID->"25f9b42f-5c90-4207-9a91-cd90094ae241"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14081, 421, 389, 10, 30, "Input",ExpressionUUID->"0eb1d422-d682-46f0-a5a4-d599ccb6978c"],
Cell[14473, 433, 521, 14, 34, "Output",ExpressionUUID->"61156102-d01f-4cb4-8a05-02722ea38217"]
}, Open  ]],
Cell[15009, 450, 852, 24, 30, "Input",ExpressionUUID->"8446243c-c928-4aed-89f3-83ce84b7e8a7"],
Cell[CellGroupData[{
Cell[15886, 478, 639, 17, 30, "Input",ExpressionUUID->"038f426e-d6c0-462b-b946-2db19e7b545a"],
Cell[16528, 497, 1975, 57, 57, "Output",ExpressionUUID->"b2ab4a7e-a97d-4eb8-abe1-1be71992ae67"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18540, 559, 641, 17, 30, "Input",ExpressionUUID->"be0c6f9d-65cc-42df-88ee-e82f3369589c"],
Cell[19184, 578, 1920, 55, 57, "Output",ExpressionUUID->"51c1f14a-767d-4be3-9cb4-bd469331a085"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21141, 638, 286, 6, 30, "Input",ExpressionUUID->"8a5c41de-7bd3-4535-af9b-fe2bd831d56f"],
Cell[21430, 646, 2169, 60, 57, "Output",ExpressionUUID->"40cca88a-6442-450b-a77c-5dbe026f659e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23636, 711, 286, 6, 30, "Input",ExpressionUUID->"543b455f-cdb8-4556-94c2-d087e8313e7f"],
Cell[23925, 719, 2138, 59, 57, "Output",ExpressionUUID->"d8fc0f37-a7f0-464d-9372-a1287c44aa91"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26100, 783, 490, 12, 30, "Input",ExpressionUUID->"8b2f748b-9297-4111-b91d-af59b9ec03ae"],
Cell[26593, 797, 1045, 29, 34, "Output",ExpressionUUID->"1ccd0b8a-dffc-4cec-a8bf-d0c4b64b5243"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27675, 831, 326, 8, 30, "Input",ExpressionUUID->"f268f808-84c8-46d0-babf-b86c438b322a"],
Cell[28004, 841, 1068, 29, 54, "Output",ExpressionUUID->"5b0c53b4-36d1-42d3-afcd-6df336bea68b"]
}, Open  ]]
}
]
*)

